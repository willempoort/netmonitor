{"generated_at":"2025-12-06T19:41:06.831474","repository":"/home/user/netmonitor","files":[{"path":"/home/user/netmonitor/update_feeds.py","relative_path":"update_feeds.py","checksum_sha256":"430a79bf43fad332a4e2ed8b836029031a5786121b1f0499f744a8afb260a69b","size_bytes":1816,"language":"python","classes":[],"functions":[{"name":"setup_logging","line":17,"parameters":[],"return_type":null},{"name":"main","line":29,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"threat_feeds","type":"local","from":"ThreatFeedManager","alias":null}],"constants":[],"entry_points":[{"type":"main","line":67}]},{"path":"/home/user/netmonitor/geoip_helper.py","relative_path":"geoip_helper.py","checksum_sha256":"b1cd37cdd764e49b99437918ad27539808bec062d8f8737da21e1884d60f9a0d","size_bytes":4666,"language":"python","classes":[],"functions":[{"name":"_get_geoip_reader","line":50,"parameters":[],"return_type":null},{"name":"is_private_ip","line":62,"parameters":["ip_str: str"],"return_type":"bool"},{"name":"get_country_for_ip","line":71,"parameters":["ip_str: str"],"return_type":"str"},{"name":"get_country_for_ips","line":140,"parameters":["ip_list: list"],"return_type":"dict"},{"name":"get_flag_emoji","line":154,"parameters":["country_code: str"],"return_type":"str"}],"imports":[{"module":"ipaddress","type":"external","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"socket","type":"standard","alias":null},{"module":"os","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"geoip2.database","type":"external","alias":null},{"module":"geoip2.errors","type":"external","alias":null}],"constants":[{"name":"GEOIP_DB_PATHS","value":"['/var/lib/GeoIP/GeoLite2-Country.mmdb', '/usr/share/GeoIP/GeoLite2-Country.mmdb', '/opt/GeoIP/GeoLi...","line":25},{"name":"GEOIP_DB_PATH","value":"None","line":33}],"entry_points":[]},{"path":"/home/user/netmonitor/database_sqlite_backup.py","relative_path":"database_sqlite_backup.py","checksum_sha256":"1a2580042e1b20311eae7fcbdef1e42f7e06019637168e8d5ee8cf1cfa7436e1","size_bytes":13630,"language":"python","classes":[{"name":"DatabaseManager","line":15,"methods":[{"name":"__init__","line":18,"parameters":["self","db_path = '/var/lib/netmonitor/netmonitor.db'"],"return_type":null},{"name":"_get_connection","line":31,"parameters":["self"],"return_type":null},{"name":"_init_database","line":38,"parameters":["self"],"return_type":null},{"name":"add_alert","line":116,"parameters":["self","alert: Dict"],"return_type":"int"},{"name":"get_recent_alerts","line":148,"parameters":["self","limit: int = 100","hours: int = 24"],"return_type":"List[Dict]"},{"name":"get_alert_statistics","line":171,"parameters":["self","hours: int = 24"],"return_type":"Dict"},{"name":"add_traffic_metrics","line":221,"parameters":["self","metrics: Dict"],"return_type":null},{"name":"get_traffic_history","line":241,"parameters":["self","hours: int = 24","limit: int = 100"],"return_type":"List[Dict]"},{"name":"update_top_talkers","line":265,"parameters":["self","talkers: List[Dict]"],"return_type":null},{"name":"get_top_talkers","line":288,"parameters":["self","limit: int = 10"],"return_type":"List[Dict]"},{"name":"add_system_stats","line":306,"parameters":["self","stats: Dict"],"return_type":null},{"name":"acknowledge_alert","line":325,"parameters":["self","alert_id: int"],"return_type":"bool"},{"name":"cleanup_old_data","line":338,"parameters":["self","days: int = 30"],"return_type":null},{"name":"get_latest_system_stats","line":361,"parameters":["self"],"return_type":"Dict"},{"name":"get_dashboard_data","line":399,"parameters":["self"],"return_type":"Dict"},{"name":"close","line":409,"parameters":["self"],"return_type":null}]}],"functions":[],"imports":[{"module":"sqlite3","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"json","type":"standard","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"datetime","type":"standard","from":"timedelta","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"typing","type":"standard","from":"List","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null},{"module":"typing","type":"standard","from":"Optional","alias":null},{"module":"threading","type":"standard","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/web_dashboard.py","relative_path":"web_dashboard.py","checksum_sha256":"29a5934ffe6adba6bde080564a7d916867980ac31203f37e2ec14545fef2717d","size_bytes":49302,"language":"python","classes":[{"name":"DashboardServer","line":1280,"methods":[{"name":"__init__","line":1283,"parameters":["self","config_file = 'config.yaml'","host = '0.0.0.0'","port = 8080"],"return_type":null},{"name":"start","line":1294,"parameters":["self"],"return_type":null},{"name":"stop","line":1322,"parameters":["self"],"return_type":null},{"name":"broadcast_alert","line":1327,"parameters":["self","alert"],"return_type":null},{"name":"broadcast_metrics","line":1335,"parameters":["self","metrics"],"return_type":null}]}],"functions":[{"name":"init_dashboard","line":79,"parameters":["config_file = 'config.yaml'"],"return_type":null},{"name":"load_user","line":143,"parameters":["user_id"],"return_type":null},{"name":"require_role","line":152,"parameters":["*roles"],"return_type":null},{"name":"require_sensor_token","line":172,"parameters":["required_permission = None"],"return_type":null},{"name":"require_sensor_token_or_login","line":219,"parameters":[],"return_type":null},{"name":"login_page","line":278,"parameters":[],"return_type":null},{"name":"api_login","line":286,"parameters":[],"return_type":null},{"name":"api_verify_2fa","line":325,"parameters":[],"return_type":null},{"name":"api_logout","line":368,"parameters":[],"return_type":null},{"name":"api_current_user","line":383,"parameters":[],"return_type":null},{"name":"api_session_debug","line":389,"parameters":[],"return_type":null},{"name":"api_setup_2fa","line":406,"parameters":[],"return_type":null},{"name":"api_disable_2fa","line":424,"parameters":[],"return_type":null},{"name":"api_change_password","line":440,"parameters":[],"return_type":null},{"name":"api_list_users","line":465,"parameters":[],"return_type":null},{"name":"api_create_user","line":478,"parameters":[],"return_type":null},{"name":"api_deactivate_user","line":513,"parameters":["user_id"],"return_type":null},{"name":"index","line":535,"parameters":[],"return_type":null},{"name":"api_status","line":540,"parameters":[],"return_type":null},{"name":"api_dashboard","line":550,"parameters":[],"return_type":null},{"name":"api_alerts","line":565,"parameters":[],"return_type":null},{"name":"api_alert_stats","line":584,"parameters":[],"return_type":null},{"name":"api_acknowledge_alert","line":600,"parameters":["alert_id"],"return_type":null},{"name":"api_traffic_history","line":619,"parameters":[],"return_type":null},{"name":"api_top_talkers","line":635,"parameters":[],"return_type":null},{"name":"api_threat_details","line":650,"parameters":["threat_type"],"return_type":null},{"name":"api_get_sensors","line":700,"parameters":[],"return_type":null},{"name":"api_register_sensor","line":723,"parameters":[],"return_type":null},{"name":"api_delete_sensor","line":755,"parameters":["sensor_id"],"return_type":null},{"name":"api_sensor_heartbeat","line":788,"parameters":["sensor_id"],"return_type":null},{"name":"api_submit_sensor_metrics","line":801,"parameters":["sensor_id"],"return_type":null},{"name":"api_submit_sensor_alerts","line":832,"parameters":["sensor_id"],"return_type":null},{"name":"api_get_sensor","line":895,"parameters":["sensor_id"],"return_type":null},{"name":"api_create_sensor_command","line":910,"parameters":["sensor_id"],"return_type":null},{"name":"api_get_sensor_commands","line":943,"parameters":["sensor_id"],"return_type":null},{"name":"api_update_command_status","line":954,"parameters":["sensor_id","command_id"],"return_type":null},{"name":"api_get_command_history","line":977,"parameters":["sensor_id"],"return_type":null},{"name":"api_get_whitelist","line":992,"parameters":[],"return_type":null},{"name":"api_add_whitelist","line":1005,"parameters":[],"return_type":null},{"name":"api_delete_whitelist","line":1041,"parameters":["entry_id"],"return_type":null},{"name":"api_check_whitelist","line":1055,"parameters":["ip_address"],"return_type":null},{"name":"api_get_config","line":1074,"parameters":[],"return_type":null},{"name":"api_get_config_parameters","line":1110,"parameters":[],"return_type":null},{"name":"api_set_config_parameter","line":1122,"parameters":[],"return_type":null},{"name":"api_delete_config_parameter","line":1169,"parameters":[],"return_type":null},{"name":"api_get_config_defaults","line":1191,"parameters":[],"return_type":null},{"name":"api_reset_config","line":1208,"parameters":[],"return_type":null},{"name":"handle_connect","line":1257,"parameters":[],"return_type":null},{"name":"handle_disconnect","line":1263,"parameters":[],"return_type":null},{"name":"handle_request_update","line":1268,"parameters":[],"return_type":null},{"name":"main","line":1344,"parameters":[],"return_type":null}],"imports":[{"module":"os","type":"standard","alias":null},{"module":"sys","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"threading","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"eventlet","type":"external","alias":null},{"module":"flask","type":"external","from":"Flask","alias":null},{"module":"flask","type":"external","from":"render_template","alias":null},{"module":"flask","type":"external","from":"jsonify","alias":null},{"module":"flask","type":"external","from":"request","alias":null},{"module":"flask","type":"external","from":"session","alias":null},{"module":"flask","type":"external","from":"g","alias":null},{"module":"flask","type":"external","from":"redirect","alias":null},{"module":"flask","type":"external","from":"url_for","alias":null},{"module":"flask_socketio","type":"external","from":"SocketIO","alias":null},{"module":"flask_socketio","type":"external","from":"emit","alias":null},{"module":"flask_cors","type":"external","from":"CORS","alias":null},{"module":"flask_login","type":"external","from":"LoginManager","alias":null},{"module":"flask_login","type":"external","from":"login_user","alias":null},{"module":"flask_login","type":"external","from":"logout_user","alias":null},{"module":"flask_login","type":"external","from":"login_required","alias":null},{"module":"flask_login","type":"external","from":"current_user","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"sensor_auth","type":"local","from":"SensorAuthManager","alias":null},{"module":"web_auth","type":"local","from":"WebAuthManager","alias":null},{"module":"web_auth","type":"local","from":"WebUser","alias":null},{"module":"functools","type":"standard","from":"wraps","alias":null},{"module":"flask","type":"external","from":"session","alias":"flask_session"},{"module":"argparse","type":"standard","alias":null},{"module":"geoip_helper","type":"local","from":"get_country_for_ips","alias":null},{"module":"config_defaults","type":"local","from":"BEST_PRACTICE_CONFIG","alias":null},{"module":"config_defaults","type":"local","from":"PARAMETER_DESCRIPTIONS","alias":null},{"module":"config_defaults","type":"local","from":"PARAMETER_CATEGORIES","alias":null},{"module":"config_defaults","type":"local","from":"BEST_PRACTICE_CONFIG","alias":null},{"module":"config_defaults","type":"local","from":"flatten_config","alias":null},{"module":"flask","type":"external","from":"g","alias":null},{"module":"config_defaults","type":"local","from":"BEST_PRACTICE_CONFIG","alias":null},{"module":"copy","type":"standard","alias":null},{"module":"flask","type":"external","from":"g","alias":null},{"module":"flask","type":"external","from":"g","alias":null},{"module":"flask","type":"external","from":"g","alias":null}],"constants":[],"entry_points":[{"type":"flask_route","function":"login_page","method":"ROUTE","line":278,"route":"/login"},{"type":"flask_route","function":"api_login","method":"ROUTE","line":286,"route":"/api/auth/login"},{"type":"flask_route","function":"api_verify_2fa","method":"ROUTE","line":325,"route":"/api/auth/verify-2fa"},{"type":"flask_route","function":"api_logout","method":"ROUTE","line":368,"route":"/api/auth/logout"},{"type":"flask_route","function":"api_current_user","method":"ROUTE","line":383,"route":"/api/auth/current-user"},{"type":"flask_route","function":"api_session_debug","method":"ROUTE","line":389,"route":"/api/auth/session-debug"},{"type":"flask_route","function":"api_setup_2fa","method":"ROUTE","line":406,"route":"/api/auth/setup-2fa"},{"type":"flask_route","function":"api_disable_2fa","method":"ROUTE","line":424,"route":"/api/auth/disable-2fa"},{"type":"flask_route","function":"api_change_password","method":"ROUTE","line":440,"route":"/api/auth/change-password"},{"type":"flask_route","function":"api_list_users","method":"ROUTE","line":465,"route":"/api/users"},{"type":"flask_route","function":"api_create_user","method":"ROUTE","line":478,"route":"/api/users"},{"type":"flask_route","function":"api_deactivate_user","method":"ROUTE","line":513,"route":"/api/users/<int:user_id>"},{"type":"flask_route","function":"index","method":"ROUTE","line":535,"route":"/"},{"type":"flask_route","function":"api_status","method":"ROUTE","line":540,"route":"/api/status"},{"type":"flask_route","function":"api_dashboard","method":"ROUTE","line":550,"route":"/api/dashboard"},{"type":"flask_route","function":"api_alerts","method":"ROUTE","line":565,"route":"/api/alerts"},{"type":"flask_route","function":"api_alert_stats","method":"ROUTE","line":584,"route":"/api/alerts/stats"},{"type":"flask_route","function":"api_acknowledge_alert","method":"ROUTE","line":600,"route":"/api/alerts/<int:alert_id>/acknowledge"},{"type":"flask_route","function":"api_traffic_history","method":"ROUTE","line":619,"route":"/api/traffic/history"},{"type":"flask_route","function":"api_top_talkers","method":"ROUTE","line":635,"route":"/api/top-talkers"},{"type":"flask_route","function":"api_threat_details","method":"ROUTE","line":650,"route":"/api/threat-details/<threat_type>"},{"type":"flask_route","function":"api_get_sensors","method":"ROUTE","line":700,"route":"/api/sensors/"},{"type":"flask_route","function":"api_register_sensor","method":"ROUTE","line":723,"route":"/api/sensors/register"},{"type":"flask_route","function":"api_delete_sensor","method":"ROUTE","line":755,"route":"/api/sensors/<sensor_id>"},{"type":"flask_route","function":"api_sensor_heartbeat","method":"ROUTE","line":788,"route":"/api/sensors/<sensor_id>/heartbeat"},{"type":"flask_route","function":"api_submit_sensor_metrics","method":"ROUTE","line":801,"route":"/api/sensors/<sensor_id>/metrics"},{"type":"flask_route","function":"api_submit_sensor_alerts","method":"ROUTE","line":832,"route":"/api/sensors/<sensor_id>/alerts"},{"type":"flask_route","function":"api_get_sensor","method":"ROUTE","line":895,"route":"/api/sensors/<sensor_id>"},{"type":"flask_route","function":"api_create_sensor_command","method":"ROUTE","line":910,"route":"/api/sensors/<sensor_id>/commands"},{"type":"flask_route","function":"api_get_sensor_commands","method":"ROUTE","line":943,"route":"/api/sensors/<sensor_id>/commands"},{"type":"flask_route","function":"api_update_command_status","method":"ROUTE","line":954,"route":"/api/sensors/<sensor_id>/commands/<int:command_id>"},{"type":"flask_route","function":"api_get_command_history","method":"ROUTE","line":977,"route":"/api/sensors/<sensor_id>/commands/history"},{"type":"flask_route","function":"api_get_whitelist","method":"ROUTE","line":992,"route":"/api/whitelist"},{"type":"flask_route","function":"api_add_whitelist","method":"ROUTE","line":1005,"route":"/api/whitelist"},{"type":"flask_route","function":"api_delete_whitelist","method":"ROUTE","line":1041,"route":"/api/whitelist/<int:entry_id>"},{"type":"flask_route","function":"api_check_whitelist","method":"ROUTE","line":1055,"route":"/api/whitelist/check/<ip_address>"},{"type":"flask_route","function":"api_get_config","method":"ROUTE","line":1074,"route":"/api/config"},{"type":"flask_route","function":"api_get_config_parameters","method":"ROUTE","line":1110,"route":"/api/config/parameters"},{"type":"flask_route","function":"api_set_config_parameter","method":"ROUTE","line":1122,"route":"/api/config/parameter"},{"type":"flask_route","function":"api_delete_config_parameter","method":"ROUTE","line":1169,"route":"/api/config/parameter"},{"type":"flask_route","function":"api_get_config_defaults","method":"ROUTE","line":1191,"route":"/api/config/defaults"},{"type":"flask_route","function":"api_reset_config","method":"ROUTE","line":1208,"route":"/api/config/reset"},{"type":"main","line":1368}]},{"path":"/home/user/netmonitor/monitor_config.py","relative_path":"monitor_config.py","checksum_sha256":"72015142978b613d3e355d22deb39b9767a8889e8120a9fc6c16749d58108938","size_bytes":2568,"language":"python","classes":[],"functions":[{"name":"main","line":15,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"time","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null}],"constants":[],"entry_points":[{"type":"main","line":80}]},{"path":"/home/user/netmonitor/config_defaults.py","relative_path":"config_defaults.py","checksum_sha256":"c35e52fd90b385ed4c9f6f8641a00529b4614d50eba606007deaa72065d94789","size_bytes":12750,"language":"python","classes":[],"functions":[{"name":"get_default_value","line":254,"parameters":["parameter_path: str"],"return_type":null},{"name":"flatten_config","line":267,"parameters":["config: dict","prefix: str = ''"],"return_type":"dict"}],"imports":[],"constants":[{"name":"BEST_PRACTICE_CONFIG","value":"{'thresholds': {'port_scan': {'enabled': True, 'unique_ports': 10, 'time_window': 60}, 'connection_f...","line":7},{"name":"PARAMETER_DESCRIPTIONS","value":"{'thresholds.port_scan.enabled': 'Enable port scan detection', 'thresholds.port_scan.unique_ports': ...","line":145},{"name":"PARAMETER_CATEGORIES","value":"{'Detection Rules': ['thresholds.port_scan', 'thresholds.connection_flood', 'thresholds.packet_size'...","line":215}],"entry_points":[]},{"path":"/home/user/netmonitor/setup_admin_user.py","relative_path":"setup_admin_user.py","checksum_sha256":"8dcc92918d6e2483031c5b86788e71dac6592d22587697d9249dac6078b7f679","size_bytes":8683,"language":"python","classes":[],"functions":[{"name":"validate_password","line":20,"parameters":["password"],"return_type":null},{"name":"main","line":36,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"getpass","type":"external","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"web_auth","type":"local","from":"WebAuthManager","alias":null},{"module":"env_loader","type":"local","from":"get_db_config","alias":null},{"module":"os","type":"standard","alias":null},{"module":"traceback","type":"standard","alias":null}],"constants":[],"entry_points":[{"type":"main","line":265}]},{"path":"/home/user/netmonitor/abuseipdb_client.py","relative_path":"abuseipdb_client.py","checksum_sha256":"9bc6397f2fe9ab35328b63717be679d622237816601f2c0098c6231503d834b4","size_bytes":6189,"language":"python","classes":[{"name":"AbuseIPDBClient","line":15,"methods":[{"name":"__init__","line":20,"parameters":["self","api_key: str","rate_limit: int = 1000"],"return_type":null},{"name":"check_ip","line":49,"parameters":["self","ip: str","max_age_days: int = 90"],"return_type":"Optional[Dict]"},{"name":"_check_rate_limit","line":125,"parameters":["self"],"return_type":"bool"},{"name":"is_malicious","line":139,"parameters":["self","ip: str","threshold: int = 50"],"return_type":"tuple"},{"name":"get_ip_info","line":160,"parameters":["self","ip: str"],"return_type":"Dict"},{"name":"get_stats","line":185,"parameters":["self"],"return_type":"Dict"},{"name":"clear_cache","line":197,"parameters":["self"],"return_type":null}]}],"functions":[],"imports":[{"module":"json","type":"standard","alias":null},{"module":"time","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"urllib.request","type":"standard","alias":null},{"module":"urllib.error","type":"standard","alias":null},{"module":"collections","type":"standard","from":"deque","alias":null},{"module":"typing","type":"standard","from":"Optional","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/threat_feeds.py","relative_path":"threat_feeds.py","checksum_sha256":"7252e49426accfff01b0aecc10a068d116410bed128b6a29496e4d53b6c6d80e","size_bytes":12957,"language":"python","classes":[{"name":"ThreatFeedManager","line":18,"methods":[{"name":"__init__","line":49,"parameters":["self","cache_dir = '/var/cache/netmonitor/feeds'"],"return_type":null},{"name":"download_feed","line":72,"parameters":["self","feed_name: str","force: bool = False"],"return_type":"bool"},{"name":"parse_feodotracker","line":124,"parameters":["self","cache_file: Path"],"return_type":"int"},{"name":"parse_urlhaus","line":157,"parameters":["self","cache_file: Path"],"return_type":"int"},{"name":"parse_threatfox","line":193,"parameters":["self","cache_file: Path"],"return_type":"int"},{"name":"parse_sslblacklist","line":236,"parameters":["self","cache_file: Path"],"return_type":"int"},{"name":"load_feeds","line":263,"parameters":["self","feed_names: List[str] = None"],"return_type":"Dict[(str, int)]"},{"name":"update_all_feeds","line":313,"parameters":["self","force: bool = False"],"return_type":"bool"},{"name":"is_malicious_ip","line":335,"parameters":["self","ip: str"],"return_type":"tuple"},{"name":"is_malicious_domain","line":347,"parameters":["self","domain: str"],"return_type":"bool"},{"name":"_is_valid_ip","line":351,"parameters":["self","ip: str"],"return_type":"bool"},{"name":"_extract_domain","line":362,"parameters":["self","url: str"],"return_type":"str"},{"name":"get_stats","line":379,"parameters":["self"],"return_type":"dict"}]}],"functions":[],"imports":[{"module":"os","type":"standard","alias":null},{"module":"json","type":"standard","alias":null},{"module":"csv","type":"standard","alias":null},{"module":"time","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"datetime","type":"standard","from":"timedelta","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null},{"module":"typing","type":"standard","from":"List","alias":null},{"module":"typing","type":"standard","from":"Set","alias":null},{"module":"urllib.request","type":"standard","alias":null},{"module":"urllib.error","type":"standard","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/test_config_sync.py","relative_path":"test_config_sync.py","checksum_sha256":"e932cfd04a16be99c358b0f2ac1ed91d82f9f6cd9335aa13a88cb1727af8fb8c","size_bytes":5173,"language":"python","classes":[],"functions":[{"name":"main","line":15,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null},{"module":"traceback","type":"standard","alias":null}],"constants":[],"entry_points":[{"type":"main","line":140}]},{"path":"/home/user/netmonitor/netmonitor.py","relative_path":"netmonitor.py","checksum_sha256":"05a13dcf5463d5bb1364fff0646486ab5fca1a1d8000e039986bd5396e53ff99","size_bytes":28699,"language":"python","classes":[{"name":"NetworkMonitor","line":35,"methods":[{"name":"__init__","line":38,"parameters":["self","config_file = 'config.yaml'"],"return_type":null},{"name":"_deep_merge_config","line":156,"parameters":["self","base: dict","override: dict"],"return_type":"dict"},{"name":"_count_config_differences","line":167,"parameters":["self","old_config: dict","new_config: dict","prefix = ''"],"return_type":"int"},{"name":"_count_dict_params","line":183,"parameters":["self","d: dict"],"return_type":"int"},{"name":"_load_config_from_database","line":193,"parameters":["self"],"return_type":null},{"name":"_sync_config_from_database","line":227,"parameters":["self"],"return_type":null},{"name":"_config_sync_loop","line":243,"parameters":["self","interval"],"return_type":null},{"name":"setup_logging","line":255,"parameters":["self"],"return_type":null},{"name":"_load_threat_feeds","line":286,"parameters":["self"],"return_type":null},{"name":"signal_handler","line":310,"parameters":["self","signum","frame"],"return_type":null},{"name":"packet_callback","line":316,"parameters":["self","packet"],"return_type":null},{"name":"get_dashboard_metrics","line":360,"parameters":["self"],"return_type":"dict"},{"name":"start","line":422,"parameters":["self"],"return_type":null}]}],"functions":[{"name":"main","line":623,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"signal","type":"external","alias":null},{"module":"argparse","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"threading","type":"standard","alias":null},{"module":"time","type":"standard","alias":null},{"module":"psutil","type":"external","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"detector","type":"local","from":"ThreatDetector","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null},{"module":"alerts","type":"local","from":"AlertManager","alias":null},{"module":"threat_feeds","type":"local","from":"ThreatFeedManager","alias":null},{"module":"behavior_detector","type":"local","from":"BehaviorDetector","alias":null},{"module":"abuseipdb_client","type":"local","from":"AbuseIPDBClient","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"metrics_collector","type":"local","from":"MetricsCollector","alias":null},{"module":"web_dashboard","type":"external","from":"DashboardServer","alias":null},{"module":"scapy.all","type":"external","from":"sniff","alias":null},{"module":"scapy.all","type":"external","from":"conf","alias":null},{"module":"scapy.layers.inet","type":"external","from":"IP","alias":null},{"module":"scapy.layers.inet","type":"external","from":"TCP","alias":null},{"module":"scapy.layers.inet","type":"external","from":"UDP","alias":null},{"module":"scapy.layers.inet","type":"external","from":"ICMP","alias":null},{"module":"scapy.layers.dns","type":"external","from":"DNS","alias":null},{"module":"psutil","type":"external","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"socket","type":"standard","alias":null}],"constants":[],"entry_points":[{"type":"main","line":674}]},{"path":"/home/user/netmonitor/test_detector.py","relative_path":"test_detector.py","checksum_sha256":"ac245ad1402959156ceab1c5e981d3e652154edf50becf1af1f3d6ef0c95e522","size_bytes":6471,"language":"python","classes":[],"functions":[{"name":"test_port_scan_detection","line":13,"parameters":[],"return_type":null},{"name":"test_connection_flood_detection","line":39,"parameters":[],"return_type":null},{"name":"test_unusual_packet_size","line":68,"parameters":[],"return_type":null},{"name":"test_dns_tunnel_detection","line":93,"parameters":[],"return_type":null},{"name":"test_blacklist","line":119,"parameters":[],"return_type":null},{"name":"test_whitelist","line":146,"parameters":[],"return_type":null},{"name":"main","line":175,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"scapy.all","type":"external","from":"IP","alias":null},{"module":"scapy.all","type":"external","from":"TCP","alias":null},{"module":"scapy.all","type":"external","from":"UDP","alias":null},{"module":"scapy.all","type":"external","from":"DNS","alias":null},{"module":"scapy.all","type":"external","from":"DNSQR","alias":null},{"module":"scapy.all","type":"external","from":"Ether","alias":null},{"module":"detector","type":"local","from":"ThreatDetector","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null}],"constants":[],"entry_points":[{"type":"main","line":228}]},{"path":"/home/user/netmonitor/check_active_config.py","relative_path":"check_active_config.py","checksum_sha256":"f58d5b5a4eb6c55e417779c0cb528beb1ac92ee9dbff165f8aa308eaab39134e","size_bytes":4288,"language":"python","classes":[],"functions":[{"name":"main","line":14,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null}],"constants":[],"entry_points":[{"type":"main","line":126}]},{"path":"/home/user/netmonitor/sensor_auth.py","relative_path":"sensor_auth.py","checksum_sha256":"e3c360140d039fb8e2e481c828bd204dcf4fe669db54a9b81a11d0b4bd74742c","size_bytes":9234,"language":"python","classes":[{"name":"SensorAuthManager","line":13,"methods":[{"name":"__init__","line":16,"parameters":["self","db_manager"],"return_type":null},{"name":"generate_token","line":26,"parameters":["self","sensor_id: str","token_name: Optional[str] = None","expires_days: Optional[int] = None","permissions: Optional[Dict] = None"],"return_type":"str"},{"name":"validate_token","line":89,"parameters":["self","token: str","required_permission: str = None"],"return_type":"Optional[Dict[(str, Any)]]"},{"name":"revoke_token","line":169,"parameters":["self","token_id: int"],"return_type":"bool"},{"name":"list_tokens","line":199,"parameters":["self","sensor_id: Optional[str] = None","include_inactive: bool = False"],"return_type":"list"},{"name":"cleanup_expired_tokens","line":263,"parameters":["self"],"return_type":"int"}]}],"functions":[],"imports":[{"module":"secrets","type":"standard","alias":null},{"module":"hashlib","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"datetime","type":"standard","from":"timedelta","alias":null},{"module":"typing","type":"standard","from":"Optional","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null},{"module":"typing","type":"standard","from":"Any","alias":null},{"module":"json","type":"standard","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/alerts.py","relative_path":"alerts.py","checksum_sha256":"f7d1d7bd5b67c2cdac5ceb92e00c347a540638c29c3b02a9d5f5e7173334878d","size_bytes":5221,"language":"python","classes":[{"name":"AlertManager","line":20,"methods":[{"name":"__init__","line":23,"parameters":["self","config"],"return_type":null},{"name":"send_alert","line":41,"parameters":["self","threat","packet"],"return_type":null},{"name":"_check_rate_limit","line":68,"parameters":["self"],"return_type":null},{"name":"_format_alert","line":79,"parameters":["self","threat","packet"],"return_type":null},{"name":"_log_to_console","line":112,"parameters":["self","message","severity"],"return_type":null},{"name":"_get_severity_color","line":123,"parameters":["self","severity"],"return_type":null},{"name":"_log_to_file","line":133,"parameters":["self","message"],"return_type":null},{"name":"_log_to_syslog","line":141,"parameters":["self","message","severity"],"return_type":null},{"name":"get_stats","line":154,"parameters":["self"],"return_type":null}]}],"functions":[],"imports":[{"module":"logging","type":"standard","alias":null},{"module":"time","type":"standard","alias":null},{"module":"collections","type":"standard","from":"deque","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"colorama","type":"external","from":"Fore","alias":null},{"module":"colorama","type":"external","from":"Style","alias":null},{"module":"colorama","type":"external","from":"init","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/show_2fa_qr.py","relative_path":"show_2fa_qr.py","checksum_sha256":"659a1a913d269897bd9ded715f5ffc649914d4fe520bfa4b407ef588a85c91d8","size_bytes":4933,"language":"python","classes":[],"functions":[{"name":"display_qr_code","line":22,"parameters":["username: str"],"return_type":null},{"name":"main","line":140,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"pyotp","type":"external","alias":null},{"module":"qrcode","type":"external","alias":null},{"module":"io","type":"standard","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"env_loader","type":"local","from":"get_db_config","alias":null},{"module":"os","type":"standard","alias":null},{"module":"traceback","type":"standard","alias":null}],"constants":[],"entry_points":[{"type":"main","line":170}]},{"path":"/home/user/netmonitor/setup_sensor_auth.py","relative_path":"setup_sensor_auth.py","checksum_sha256":"a240d870c7859e1039bdbefadb213cc223121a1e7bedeebf3b2ef9b76a888aab","size_bytes":3503,"language":"python","classes":[],"functions":[{"name":"main","line":18,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"sensor_auth","type":"local","from":"SensorAuthManager","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null}],"constants":[],"entry_points":[{"type":"main","line":119}]},{"path":"/home/user/netmonitor/config_loader.py","relative_path":"config_loader.py","checksum_sha256":"990854d01d10d5f57b82ffc3b5c589ffb0640c4385ccd957842d0d139446d4a0","size_bytes":7350,"language":"python","classes":[],"functions":[{"name":"_parse_conf_file","line":11,"parameters":["config_file"],"return_type":null},{"name":"_build_sensor_config","line":43,"parameters":["conf_dict"],"return_type":null},{"name":"load_config","line":203,"parameters":["config_file"],"return_type":null}],"imports":[{"module":"yaml","type":"external","alias":null},{"module":"os","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/whitelist_sensors.py","relative_path":"whitelist_sensors.py","checksum_sha256":"9394d8829280ddc4eca269a01d40cdb252b65131ab3fcc600ba6dedb8f7f33f5","size_bytes":2131,"language":"python","classes":[],"functions":[{"name":"whitelist_sensors","line":11,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null}],"constants":[],"entry_points":[{"type":"main","line":70}]},{"path":"/home/user/netmonitor/init_database_defaults.py","relative_path":"init_database_defaults.py","checksum_sha256":"3a2d2d0593d0eb44f77bf158226523ee6db35a736b8c58548a60125866ca5659","size_bytes":3222,"language":"python","classes":[],"functions":[{"name":"flatten_config","line":11,"parameters":["config_dict","parent_key = ''","sep = '.'"],"return_type":null},{"name":"load_defaults","line":26,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null}],"constants":[],"entry_points":[{"type":"main","line":102}]},{"path":"/home/user/netmonitor/content_analysis.py","relative_path":"content_analysis.py","checksum_sha256":"e0764b252257de93f997232db3c54cf51add94945d8efeea27ecab4af882d13a","size_bytes":9780,"language":"python","classes":[{"name":"ContentAnalyzer","line":13,"methods":[{"name":"calculate_entropy","line":35,"parameters":["data: str"],"return_type":"float"},{"name":"detect_encoding","line":60,"parameters":["data: str"],"return_type":"Dict[(str, any)]"},{"name":"analyze_dns_query","line":112,"parameters":["query: str"],"return_type":"Dict[(str, any)]"},{"name":"scan_for_sensitive_data","line":172,"parameters":["data: str","max_length: int = 10000"],"return_type":"List[Dict]"},{"name":"analyze_http_payload","line":214,"parameters":["payload: bytes","max_size: int = 50000"],"return_type":"Dict[(str, any)]"}]}],"functions":[{"name":"calculate_entropy","line":266,"parameters":["data: str"],"return_type":"float"},{"name":"is_likely_encoded","line":271,"parameters":["data: str"],"return_type":"bool"},{"name":"analyze_dns","line":277,"parameters":["query: str"],"return_type":"Dict"}],"imports":[{"module":"math","type":"standard","alias":null},{"module":"re","type":"standard","alias":null},{"module":"base64","type":"standard","alias":null},{"module":"collections","type":"standard","from":"Counter","alias":null},{"module":"typing","type":"standard","from":"Tuple","alias":null},{"module":"typing","type":"standard","from":"Optional","alias":null},{"module":"typing","type":"standard","from":"List","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/sensor_client.py","relative_path":"sensor_client.py","checksum_sha256":"82490cecd35b8269a6f6a1ddcb8d1d36866df32de1bf1146070d6fb4133f1f37","size_bytes":44535,"language":"python","classes":[{"name":"SensorClient","line":126,"methods":[{"name":"__init__","line":129,"parameters":["self","config_file = 'config.yaml'","server_url = None","sensor_id = None","location = None","batch_interval = 30"],"return_type":null},{"name":"_generate_sensor_id","line":212,"parameters":["self"],"return_type":null},{"name":"_normalize_server_url","line":218,"parameters":["self","url"],"return_type":null},{"name":"_get_headers","line":265,"parameters":["self"],"return_type":null},{"name":"_setup_logging","line":272,"parameters":["self"],"return_type":null},{"name":"_init_components","line":300,"parameters":["self"],"return_type":null},{"name":"_update_config","line":351,"parameters":["self"],"return_type":null},{"name":"_deep_merge_config","line":407,"parameters":["self","base: dict","override: dict"],"return_type":"dict"},{"name":"_count_config_differences","line":419,"parameters":["self","base: dict","override: dict","prefix: str = ''"],"return_type":"int"},{"name":"_update_whitelist","line":435,"parameters":["self"],"return_type":null},{"name":"_register_sensor","line":472,"parameters":["self"],"return_type":null},{"name":"_send_heartbeat","line":553,"parameters":["self"],"return_type":null},{"name":"_poll_commands","line":571,"parameters":["self"],"return_type":null},{"name":"_execute_command","line":591,"parameters":["self","command"],"return_type":null},{"name":"_send_metrics","line":806,"parameters":["self"],"return_type":null},{"name":"_upload_alert_immediate","line":858,"parameters":["self","alert"],"return_type":null},{"name":"_upload_alerts","line":882,"parameters":["self"],"return_type":null},{"name":"_handle_packet","line":920,"parameters":["self","packet"],"return_type":null},{"name":"start","line":970,"parameters":["self"],"return_type":null},{"name":"stop","line":1065,"parameters":["self"],"return_type":null}]}],"functions":[{"name":"load_sensor_config","line":32,"parameters":["config_file"],"return_type":null},{"name":"_load_bash_config","line":63,"parameters":["config_file"],"return_type":null},{"name":"main","line":1086,"parameters":[],"return_type":null}],"imports":[{"module":"os","type":"standard","alias":null},{"module":"sys","type":"standard","alias":null},{"module":"time","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"socket","type":"standard","alias":null},{"module":"psutil","type":"external","alias":null},{"module":"requests","type":"external","alias":null},{"module":"argparse","type":"standard","alias":null},{"module":"signal","type":"external","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"collections","type":"standard","from":"deque","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null},{"module":"detector","type":"local","from":"ThreatDetector","alias":null},{"module":"threat_feeds","type":"local","from":"ThreatFeedManager","alias":null},{"module":"behavior_detector","type":"local","from":"BehaviorDetector","alias":null},{"module":"abuseipdb_client","type":"local","from":"AbuseIPDBClient","alias":null},{"module":"scapy.all","type":"external","from":"sniff","alias":null},{"module":"scapy.all","type":"external","from":"conf","alias":null},{"module":"urllib.parse","type":"standard","from":"urlparse","alias":null},{"module":"urllib.parse","type":"standard","from":"urlunparse","alias":null},{"module":"threading","type":"standard","alias":null},{"module":"subprocess","type":"standard","alias":null},{"module":"traceback","type":"standard","alias":null},{"module":"subprocess","type":"standard","alias":null},{"module":"subprocess","type":"standard","alias":null}],"constants":[],"entry_points":[{"type":"main","line":1122}]},{"path":"/home/user/netmonitor/debug_whitelist.py","relative_path":"debug_whitelist.py","checksum_sha256":"dc242f085b2288b14d141632627d683c99f9e31bbe34f0f83c9596733fde353f","size_bytes":5662,"language":"python","classes":[],"functions":[{"name":"main","line":14,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null}],"constants":[],"entry_points":[{"type":"main","line":168}]},{"path":"/home/user/netmonitor/web_auth.py","relative_path":"web_auth.py","checksum_sha256":"231260813b10da12d571a50460cdc5aefac79d7999dbfc26fa1b12f702b0a8b0","size_bytes":26743,"language":"python","classes":[{"name":"WebUser","line":20,"methods":[{"name":"__init__","line":23,"parameters":["self","user_data: Dict[(str, Any)]"],"return_type":null},{"name":"is_authenticated","line":35,"parameters":["self"],"return_type":null},{"name":"is_anonymous","line":40,"parameters":["self"],"return_type":null},{"name":"get_id","line":44,"parameters":["self"],"return_type":null},{"name":"__repr__","line":48,"parameters":["self"],"return_type":null},{"name":"__str__","line":52,"parameters":["self"],"return_type":null},{"name":"to_dict","line":56,"parameters":["self"],"return_type":null}]},{"name":"WebAuthManager","line":69,"methods":[{"name":"__init__","line":72,"parameters":["self","db_manager"],"return_type":null},{"name":"create_user","line":86,"parameters":["self","username: str","password: str","email: Optional[str] = None","role: str = 'operator'","created_by: Optional[str] = None","enable_2fa: bool = False"],"return_type":"Optional[WebUser]"},{"name":"authenticate","line":166,"parameters":["self","username: str","password: str","ip_address: Optional[str] = None","user_agent: Optional[str] = None"],"return_type":"Optional[WebUser]"},{"name":"verify_2fa","line":295,"parameters":["self","user: WebUser","code: str","ip_address: Optional[str] = None","user_agent: Optional[str] = None","is_backup_code: bool = False"],"return_type":"bool"},{"name":"setup_2fa","line":346,"parameters":["self","user_id: int","app_name: str = 'NetMonitor'"],"return_type":"Optional[Dict[(str, Any)]]"},{"name":"disable_2fa","line":416,"parameters":["self","user_id: int"],"return_type":"bool"},{"name":"get_user_by_id","line":448,"parameters":["self","user_id: int"],"return_type":"Optional[WebUser]"},{"name":"get_user_by_username","line":489,"parameters":["self","username: str"],"return_type":"Optional[WebUser]"},{"name":"list_users","line":530,"parameters":["self","include_inactive: bool = False"],"return_type":"List[Dict[(str, Any)]]"},{"name":"change_password","line":575,"parameters":["self","user_id: int","old_password: str","new_password: str"],"return_type":"bool"},{"name":"deactivate_user","line":633,"parameters":["self","user_id: int","deactivated_by: Optional[str] = None"],"return_type":"bool"},{"name":"audit_log","line":664,"parameters":["self","user_id: Optional[int]","event_type: str","ip_address: Optional[str] = None","username: Optional[str] = None","details: Optional[Dict] = None"],"return_type":null},{"name":"_check_rate_limit","line":697,"parameters":["self","username: str"],"return_type":"bool"},{"name":"_verify_backup_code","line":726,"parameters":["self","user: WebUser","code: str"],"return_type":"bool"},{"name":"_update_last_login","line":777,"parameters":["self","user_id: int"],"return_type":null}]}],"functions":[],"imports":[{"module":"secrets","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"hashlib","type":"standard","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"datetime","type":"standard","from":"timedelta","alias":null},{"module":"typing","type":"standard","from":"Optional","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null},{"module":"typing","type":"standard","from":"Any","alias":null},{"module":"typing","type":"standard","from":"List","alias":null},{"module":"argon2","type":"external","from":"PasswordHasher","alias":null},{"module":"argon2.exceptions","type":"external","from":"VerifyMismatchError","alias":null},{"module":"pyotp","type":"external","alias":null},{"module":"qrcode","type":"external","alias":null},{"module":"io","type":"standard","alias":null},{"module":"base64","type":"standard","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/behavior_detector.py","relative_path":"behavior_detector.py","checksum_sha256":"a897a9448a0eb15c229891e7d8ec5e8c86297601bc4c8b6f5e44b57f5d8d078d","size_bytes":14048,"language":"python","classes":[{"name":"BehaviorDetector","line":17,"methods":[{"name":"__init__","line":20,"parameters":["self","config"],"return_type":null},{"name":"_get_threshold","line":54,"parameters":["self","*keys"],"return_type":null},{"name":"_parse_internal_networks","line":72,"parameters":["self"],"return_type":null},{"name":"is_internal_ip","line":97,"parameters":["self","ip_str: str"],"return_type":"bool"},{"name":"analyze_packet","line":105,"parameters":["self","packet"],"return_type":"List[dict]"},{"name":"_detect_beaconing","line":145,"parameters":["self","packet"],"return_type":"dict"},{"name":"_track_outbound_volume","line":240,"parameters":["self","packet"],"return_type":"dict"},{"name":"_detect_lateral_movement","line":304,"parameters":["self","packet"],"return_type":"dict"},{"name":"cleanup_old_data","line":387,"parameters":["self"],"return_type":null}]}],"functions":[],"imports":[{"module":"time","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"json","type":"standard","alias":null},{"module":"ipaddress","type":"external","alias":null},{"module":"collections","type":"standard","from":"defaultdict","alias":null},{"module":"collections","type":"standard","from":"deque","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null},{"module":"typing","type":"standard","from":"List","alias":null},{"module":"typing","type":"standard","from":"Tuple","alias":null},{"module":"scapy.layers.inet","type":"external","from":"IP","alias":null},{"module":"scapy.layers.inet","type":"external","from":"TCP","alias":null},{"module":"scapy.layers.inet","type":"external","from":"UDP","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/debug_config.py","relative_path":"debug_config.py","checksum_sha256":"414330e6c532ad175b4c2eebe75b46d832c6bb392481ce5b7a83f41f8d2aa033","size_bytes":4588,"language":"python","classes":[],"functions":[{"name":"main","line":15,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"json","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null}],"constants":[],"entry_points":[{"type":"main","line":136}]},{"path":"/home/user/netmonitor/test_whitelist_query.py","relative_path":"test_whitelist_query.py","checksum_sha256":"758636b59fc8df17da1a53e6ac47e4766837f9875548a0d5ef9231416064d1ec","size_bytes":4295,"language":"python","classes":[],"functions":[{"name":"main","line":14,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"config_loader","type":"local","from":"load_config","alias":null}],"constants":[],"entry_points":[{"type":"main","line":123}]},{"path":"/home/user/netmonitor/env_loader.py","relative_path":"env_loader.py","checksum_sha256":"a74bf1f283b7db01fc35b59cd6e5bed3db6807dd6b3cdc5a6c1e10bb8ff513d6","size_bytes":3620,"language":"python","classes":[],"functions":[{"name":"load_env","line":12,"parameters":["env_file: str = '.env'","base_path: Optional[str] = None"],"return_type":"Dict[(str, str)]"},{"name":"get_env","line":60,"parameters":["key: str","default: Optional[str] = None","env_file: str = '.env'"],"return_type":"Optional[str]"},{"name":"load_env_into_environ","line":86,"parameters":["env_file: str = '.env'","override: bool = False"],"return_type":"int"},{"name":"get_db_config","line":108,"parameters":["env_file: str = '.env'"],"return_type":"Dict[(str, any)]"}],"imports":[{"module":"os","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"typing","type":"standard","from":"Optional","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/detector.py","relative_path":"detector.py","checksum_sha256":"febb7c2656eed4aee7509620ee2a32f8403ccbf8691116a3db6b7223f637f2ea","size_bytes":37368,"language":"python","classes":[{"name":"ThreatDetector","line":26,"methods":[{"name":"__init__","line":29,"parameters":["self","config","threat_feed_manager = None","behavior_detector = None","abuseipdb_client = None","db_manager = None","sensor_id = None"],"return_type":null},{"name":"_get_threshold","line":76,"parameters":["self","*keys"],"return_type":null},{"name":"_parse_ip_list","line":94,"parameters":["self","ip_list"],"return_type":null},{"name":"_is_in_list","line":108,"parameters":["self","ip_str","ip_list"],"return_type":null},{"name":"_is_whitelisted","line":119,"parameters":["self","ip_str"],"return_type":null},{"name":"analyze_packet","line":137,"parameters":["self","packet"],"return_type":null},{"name":"_detect_port_scan","line":253,"parameters":["self","packet"],"return_type":null},{"name":"_detect_connection_flood","line":308,"parameters":["self","packet"],"return_type":null},{"name":"_detect_unusual_packet_size","line":348,"parameters":["self","packet"],"return_type":null},{"name":"_detect_dns_tunnel","line":369,"parameters":["self","packet"],"return_type":null},{"name":"_detect_icmp_tunnel","line":464,"parameters":["self","packet"],"return_type":null},{"name":"_detect_http_anomalies","line":535,"parameters":["self","packet"],"return_type":null},{"name":"_detect_smtp_ftp_transfer","line":647,"parameters":["self","packet"],"return_type":null},{"name":"_detect_brute_force","line":722,"parameters":["self","packet"],"return_type":null},{"name":"_detect_protocol_mismatch","line":800,"parameters":["self","packet"],"return_type":null},{"name":"cleanup_old_data","line":894,"parameters":["self"],"return_type":null}]}],"functions":[],"imports":[{"module":"time","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"json","type":"standard","alias":null},{"module":"collections","type":"standard","from":"defaultdict","alias":null},{"module":"collections","type":"standard","from":"deque","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"datetime","type":"standard","from":"timedelta","alias":null},{"module":"ipaddress","type":"external","alias":null},{"module":"scapy.layers.inet","type":"external","from":"IP","alias":null},{"module":"scapy.layers.inet","type":"external","from":"TCP","alias":null},{"module":"scapy.layers.inet","type":"external","from":"UDP","alias":null},{"module":"scapy.layers.inet","type":"external","from":"ICMP","alias":null},{"module":"scapy.layers.dns","type":"external","from":"DNS","alias":null},{"module":"scapy.layers.dns","type":"external","from":"DNSQR","alias":null},{"module":"scapy.layers.http","type":"external","from":"HTTP","alias":null},{"module":"scapy.layers.http","type":"external","from":"HTTPRequest","alias":null},{"module":"scapy.layers.http","type":"external","from":"HTTPResponse","alias":null},{"module":"scapy.packet","type":"external","from":"Raw","alias":null},{"module":"content_analysis","type":"local","from":"ContentAnalyzer","alias":null},{"module":"content_analysis","type":"local","from":"analyze_dns","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/database.py","relative_path":"database.py","checksum_sha256":"1c83857841903c1ec3cbbdd95061f93444c5f3e1cbb16469b93e38a085c53124","size_bytes":70040,"language":"python","classes":[{"name":"DatabaseManager","line":16,"methods":[{"name":"__init__","line":19,"parameters":["self","host = 'localhost'","port = 5432","database = 'netmonitor'","user = 'netmonitor'","password = 'netmonitor'","min_connections = 2","max_connections = 10"],"return_type":null},{"name":"_get_connection","line":49,"parameters":["self"],"return_type":null},{"name":"_return_connection","line":53,"parameters":["self","conn"],"return_type":null},{"name":"_init_database","line":57,"parameters":["self"],"return_type":null},{"name":"_setup_timescaledb","line":377,"parameters":["self"],"return_type":null},{"name":"add_alert","line":525,"parameters":["self","alert: Dict"],"return_type":"int"},{"name":"get_recent_alerts","line":558,"parameters":["self","limit: int = 100","hours: int = 24"],"return_type":"List[Dict]"},{"name":"get_alert_statistics","line":591,"parameters":["self","hours: int = 24"],"return_type":"Dict"},{"name":"add_traffic_metrics","line":647,"parameters":["self","metrics: Dict"],"return_type":null},{"name":"get_traffic_history","line":674,"parameters":["self","hours: int = 24","limit: int = 100"],"return_type":"List[Dict]"},{"name":"update_top_talkers","line":709,"parameters":["self","talkers: List[Dict]"],"return_type":null},{"name":"get_top_talkers","line":740,"parameters":["self","limit: int = 10"],"return_type":"List[Dict]"},{"name":"add_system_stats","line":770,"parameters":["self","stats: Dict"],"return_type":null},{"name":"get_latest_system_stats","line":795,"parameters":["self"],"return_type":"Dict"},{"name":"acknowledge_alert","line":834,"parameters":["self","alert_id: int"],"return_type":"bool"},{"name":"get_threat_type_details","line":852,"parameters":["self","threat_type: str","hours: int = 24","limit: int = 100"],"return_type":"Dict"},{"name":"get_dashboard_data","line":991,"parameters":["self"],"return_type":"Dict"},{"name":"register_sensor","line":1003,"parameters":["self","sensor_id: str","hostname: str","location: str = None","ip_address: str = None","version: str = None","config: Dict = None"],"return_type":"bool"},{"name":"deregister_sensor","line":1036,"parameters":["self","sensor_id: str"],"return_type":"bool"},{"name":"update_sensor_heartbeat","line":1057,"parameters":["self","sensor_id: str"],"return_type":"bool"},{"name":"get_sensors","line":1076,"parameters":["self"],"return_type":"List[Dict]"},{"name":"get_sensor_by_id","line":1147,"parameters":["self","sensor_id: str"],"return_type":"Optional[Dict]"},{"name":"save_sensor_metrics","line":1183,"parameters":["self","sensor_id: str","cpu_percent: float = None","memory_percent: float = None","disk_percent: float = None","uptime_seconds: int = None","packets_captured: int = None","alerts_sent: int = None","network_interface: str = None","bandwidth_mbps: float = None"],"return_type":"bool"},{"name":"get_sensor_metrics","line":1225,"parameters":["self","sensor_id: str","hours: int = 24"],"return_type":"List[Dict]"},{"name":"get_aggregated_metrics","line":1256,"parameters":["self"],"return_type":"Dict"},{"name":"insert_alert_from_sensor","line":1365,"parameters":["self","sensor_id: str","severity: str","threat_type: str","source_ip: str = None","destination_ip: str = None","description: str = None","metadata: Dict = None","timestamp: datetime = None"],"return_type":"bool"},{"name":"create_sensor_command","line":1395,"parameters":["self","sensor_id: str","command_type: str","parameters: Dict = None"],"return_type":"Optional[int]"},{"name":"get_pending_commands","line":1419,"parameters":["self","sensor_id: str"],"return_type":"List[Dict]"},{"name":"update_command_status","line":1446,"parameters":["self","command_id: int","status: str","result: Dict = None"],"return_type":"bool"},{"name":"get_sensor_command_history","line":1468,"parameters":["self","sensor_id: str","limit: int = 50"],"return_type":"List[Dict]"},{"name":"add_whitelist_entry","line":1500,"parameters":["self","ip_cidr: str","description: str = None","scope: str = 'global'","sensor_id: str = None","created_by: str = 'system'"],"return_type":"Optional[int]"},{"name":"get_whitelist","line":1531,"parameters":["self","scope: str = None","sensor_id: str = None"],"return_type":"List[Dict]"},{"name":"delete_whitelist_entry","line":1566,"parameters":["self","entry_id: int"],"return_type":"bool"},{"name":"check_ip_whitelisted","line":1582,"parameters":["self","ip_address: str","sensor_id: str = None"],"return_type":"bool"},{"name":"set_config_parameter","line":1613,"parameters":["self","parameter_path: str","value: Any","sensor_id: str = None","scope: str = 'global'","description: str = None","updated_by: str = None"],"return_type":"bool"},{"name":"get_sensor_config","line":1650,"parameters":["self","sensor_id: str = None","parameter_path: str = None"],"return_type":"Dict"},{"name":"get_all_config_parameters","line":1728,"parameters":["self","sensor_id: str = None"],"return_type":"List[Dict]"},{"name":"delete_config_parameter","line":1768,"parameters":["self","parameter_path: str","sensor_id: str = None"],"return_type":"bool"},{"name":"close","line":1795,"parameters":["self"],"return_type":null}]}],"functions":[],"imports":[{"module":"psycopg2","type":"external","alias":null},{"module":"psycopg2","type":"external","from":"pool","alias":null},{"module":"psycopg2.extras","type":"external","from":"RealDictCursor","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"json","type":"standard","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"datetime","type":"standard","from":"timedelta","alias":null},{"module":"typing","type":"standard","from":"List","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null},{"module":"typing","type":"standard","from":"Optional","alias":null},{"module":"typing","type":"standard","from":"Any","alias":null},{"module":"threading","type":"standard","alias":null},{"module":"decimal","type":"standard","from":"Decimal","alias":null},{"module":"json","type":"standard","alias":null},{"module":"json","type":"standard","alias":null},{"module":"json","type":"standard","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/metrics_collector.py","relative_path":"metrics_collector.py","checksum_sha256":"735cca5ae88dd70cfb4a636207882bdcaf2932fb78312d116ac64033528072d3","size_bytes":10770,"language":"python","classes":[{"name":"MetricsCollector","line":16,"methods":[{"name":"__init__","line":19,"parameters":["self","config","database_manager = None"],"return_type":null},{"name":"_parse_internal_networks","line":59,"parameters":["self"],"return_type":null},{"name":"is_internal_ip","line":84,"parameters":["self","ip_str: str"],"return_type":"bool"},{"name":"track_packet","line":92,"parameters":["self","packet"],"return_type":null},{"name":"track_alert","line":152,"parameters":["self"],"return_type":null},{"name":"get_current_stats","line":156,"parameters":["self"],"return_type":"Dict"},{"name":"get_top_talkers","line":202,"parameters":["self","limit: int = 10"],"return_type":"List[Dict]"},{"name":"get_system_stats","line":229,"parameters":["self"],"return_type":"Dict"},{"name":"save_metrics","line":251,"parameters":["self"],"return_type":null},{"name":"reset_counters","line":289,"parameters":["self"],"return_type":null},{"name":"get_dashboard_metrics","line":303,"parameters":["self"],"return_type":"Dict"}]}],"functions":[],"imports":[{"module":"time","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"psutil","type":"external","alias":null},{"module":"socket","type":"standard","alias":null},{"module":"collections","type":"standard","from":"defaultdict","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null},{"module":"typing","type":"standard","from":"List","alias":null},{"module":"ipaddress","type":"external","alias":null},{"module":"scapy.layers.inet","type":"external","from":"IP","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/mcp_server/manage_tokens.py","relative_path":"mcp_server/manage_tokens.py","checksum_sha256":"3cc4a839e551ac83442a4565d6d36019e72cb0c364395e4e8b31f00160b3faf4","size_bytes":11782,"language":"python","classes":[],"functions":[{"name":"create_token_manager","line":28,"parameters":[],"return_type":null},{"name":"cmd_create","line":54,"parameters":["args"],"return_type":null},{"name":"cmd_list","line":86,"parameters":["args"],"return_type":null},{"name":"cmd_show","line":130,"parameters":["args"],"return_type":null},{"name":"cmd_revoke","line":187,"parameters":["args"],"return_type":null},{"name":"cmd_stats","line":207,"parameters":["args"],"return_type":null},{"name":"main","line":249,"parameters":[],"return_type":null}],"imports":[{"module":"os","type":"standard","alias":null},{"module":"sys","type":"standard","alias":null},{"module":"argparse","type":"standard","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"tabulate","type":"external","from":"tabulate","alias":null},{"module":"token_auth","type":"local","from":"TokenAuthManager","alias":null},{"module":"env_loader","type":"local","from":"get_db_config","alias":null}],"constants":[],"entry_points":[{"type":"main","line":332}]},{"path":"/home/user/netmonitor/mcp_server/ollama_client.py","relative_path":"mcp_server/ollama_client.py","checksum_sha256":"026630f81687d1ba40fab7ce17338459a8d13bd27a076d354dfff5738601f53c","size_bytes":9256,"language":"python","classes":[{"name":"OllamaClient","line":16,"methods":[{"name":"__init__","line":19,"parameters":["self","base_url: str = 'http://localhost:11434'","model: str = 'llama3.2'"],"return_type":null},{"name":"_check_availability","line":34,"parameters":["self"],"return_type":"bool"},{"name":"generate","line":57,"parameters":["self","prompt: str","system: Optional[str] = None","temperature: float = 0.7","max_tokens: int = 2000"],"return_type":"Dict"},{"name":"analyze_threat","line":125,"parameters":["self","alert: Dict"],"return_type":"Dict"},{"name":"suggest_incident_response","line":169,"parameters":["self","alert: Dict","context: Optional[str] = None"],"return_type":"Dict"},{"name":"explain_ioc","line":213,"parameters":["self","ioc: str","ioc_type: str = 'ip'"],"return_type":"Dict"},{"name":"list_available_models","line":251,"parameters":["self"],"return_type":"List[Dict]"},{"name":"get_status","line":270,"parameters":["self"],"return_type":"Dict"}]}],"functions":[],"imports":[{"module":"logging","type":"standard","alias":null},{"module":"json","type":"standard","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null},{"module":"typing","type":"standard","from":"Optional","alias":null},{"module":"typing","type":"standard","from":"List","alias":null},{"module":"requests","type":"external","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/mcp_server/netmonitor_openwebui_function.py","relative_path":"mcp_server/netmonitor_openwebui_function.py","checksum_sha256":"d737ab9faef07a124e622aedc49e487f01e7ff750eeb083c7f9c3a158aff125f","size_bytes":9580,"language":"python","classes":[{"name":"Tools","line":17,"methods":[{"name":"__init__","line":35,"parameters":["self"],"return_type":null},{"name":"_call_mcp_api","line":38,"parameters":["self","tool_name: str","parameters: dict"],"return_type":"dict"},{"name":"get_recent_threats","line":79,"parameters":["self","hours: int = 24","severity: Optional[str] = None","limit: int = 50"],"return_type":"str"},{"name":"analyze_ip","line":147,"parameters":["self","ip_address: str","hours: int = 24"],"return_type":"str"},{"name":"get_sensor_status","line":218,"parameters":["self"],"return_type":"str"},{"name":"get_dashboard_summary","line":260,"parameters":["self"],"return_type":"str"}]},{"name":"Valves","line":20,"methods":[]}],"functions":[],"imports":[{"module":"requests","type":"external","alias":null},{"module":"json","type":"standard","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"typing","type":"standard","from":"Optional","alias":null},{"module":"typing","type":"standard","from":"List","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null},{"module":"pydantic","type":"external","from":"BaseModel","alias":null},{"module":"pydantic","type":"external","from":"Field","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/mcp_server/__init__.py","relative_path":"mcp_server/__init__.py","checksum_sha256":"ee36d7b545c8080b7ce86d5dcbca7d92ccd1d1f1e3f3607d68e3cd200d362246","size_bytes":128,"language":"python","classes":[],"functions":[],"imports":[],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/mcp_server/database_client.py","relative_path":"mcp_server/database_client.py","checksum_sha256":"7bd45df199d1929d0df3a2d17aec6248e286b0a396761afa05a0ec66e839fdaa","size_bytes":14427,"language":"python","classes":[{"name":"MCPDatabaseClient","line":12,"methods":[{"name":"__init__","line":15,"parameters":["self","host: str","database: str","user: str","password: str","port: int = 5432"],"return_type":null},{"name":"get_alerts_by_ip","line":46,"parameters":["self","ip_address: str","hours: int = 24"],"return_type":"List[Dict]"},{"name":"get_recent_alerts","line":85,"parameters":["self","limit: int = 50","hours: int = 24","severity: Optional[str] = None","threat_type: Optional[str] = None"],"return_type":"List[Dict]"},{"name":"get_threat_timeline","line":142,"parameters":["self","source_ip: Optional[str] = None","hours: int = 24"],"return_type":"List[Dict]"},{"name":"get_dashboard_stats","line":190,"parameters":["self"],"return_type":"Dict"},{"name":"get_traffic_trends","line":258,"parameters":["self","hours: int = 24","interval: str = 'hourly'"],"return_type":"List[Dict]"},{"name":"get_top_talkers_stats","line":302,"parameters":["self","hours: int = 24","limit: int = 20","direction: Optional[str] = None"],"return_type":"List[Dict]"},{"name":"get_alert_statistics","line":351,"parameters":["self","hours: int = 24","group_by: str = 'severity'"],"return_type":"Dict"},{"name":"close","line":434,"parameters":["self"],"return_type":null}]}],"functions":[],"imports":[{"module":"psycopg2","type":"external","alias":null},{"module":"psycopg2.extras","type":"external","from":"RealDictCursor","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"datetime","type":"standard","from":"timedelta","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"typing","type":"standard","from":"List","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null},{"module":"typing","type":"standard","from":"Optional","alias":null}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/mcp_server/token_auth.py","relative_path":"mcp_server/token_auth.py","checksum_sha256":"f6d9377b3a8e00b24c931b260c10949c3c147684366840902997489f5a3a73d8","size_bytes":13447,"language":"python","classes":[{"name":"TokenAuthManager","line":24,"methods":[{"name":"__init__","line":27,"parameters":["self","db_config: Dict[(str, Any)]"],"return_type":null},{"name":"_connect","line":39,"parameters":["self"],"return_type":null},{"name":"_ensure_connection","line":54,"parameters":["self"],"return_type":null},{"name":"generate_token","line":62,"parameters":["self"],"return_type":"str"},{"name":"create_token","line":71,"parameters":["self","name: str","description: str = ''","scope: str = 'read_only'","rate_limit_per_minute: Optional[int] = 60","rate_limit_per_hour: Optional[int] = 1000","rate_limit_per_day: Optional[int] = 10000","expires_in_days: Optional[int] = None","created_by: Optional[str] = None"],"return_type":"Dict[(str, Any)]"},{"name":"validate_token","line":131,"parameters":["self","token: str"],"return_type":"Optional[Dict[(str, Any)]]"},{"name":"check_rate_limit","line":181,"parameters":["self","token_id: int","token_details: Dict[(str, Any)]"],"return_type":"bool"},{"name":"log_request","line":229,"parameters":["self","token_id: int","endpoint: str","method: str","ip_address: Optional[str] = None","user_agent: Optional[str] = None","status_code: Optional[int] = None","response_time_ms: Optional[int] = None","error_message: Optional[str] = None"],"return_type":null},{"name":"get_token_stats","line":274,"parameters":["self","token_id: int"],"return_type":"Dict[(str, Any)]"},{"name":"list_tokens","line":311,"parameters":["self","include_disabled: bool = False"],"return_type":"list"},{"name":"revoke_token","line":349,"parameters":["self","token_id: int"],"return_type":null}]}],"functions":[],"imports":[{"module":"secrets","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"datetime","type":"standard","from":"timedelta","alias":null},{"module":"typing","type":"standard","from":"Optional","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null},{"module":"typing","type":"standard","from":"Any","alias":null},{"module":"collections","type":"standard","from":"defaultdict","alias":null},{"module":"psycopg2","type":"external","alias":null},{"module":"psycopg2.extras","type":"external","alias":null},{"module":"fastapi","type":"external","from":"HTTPException","alias":null},{"module":"fastapi","type":"external","from":"Security","alias":null},{"module":"fastapi","type":"external","from":"status","alias":null},{"module":"fastapi.security","type":"external","from":"HTTPBearer","alias":null},{"module":"fastapi.security","type":"external","from":"HTTPAuthorizationCredentials","alias":null},{"module":"fastapi","type":"external","from":"Request","alias":null},{"module":"fastapi.requests","type":"external","from":"Request","alias":"FastAPIRequest"}],"constants":[],"entry_points":[]},{"path":"/home/user/netmonitor/mcp_server/http_server.py","relative_path":"mcp_server/http_server.py","checksum_sha256":"792ca713d0dd054b667fe3512cf6fd638f038c31b029fdebb29e9539af100bba","size_bytes":25782,"language":"python","classes":[{"name":"ToolRequest","line":56,"methods":[]},{"name":"ToolResponse","line":62,"methods":[]},{"name":"ToolInfo","line":72,"methods":[]},{"name":"ResourceInfo","line":80,"methods":[]},{"name":"MCPHTTPServer","line":90,"methods":[{"name":"__init__","line":93,"parameters":["self"],"return_type":null},{"name":"_init_database","line":123,"parameters":["self"],"return_type":null},{"name":"_init_ollama","line":147,"parameters":["self"],"return_type":null},{"name":"_init_token_manager","line":164,"parameters":["self"],"return_type":null},{"name":"_configure_middleware","line":188,"parameters":["self"],"return_type":null},{"name":"_register_routes","line":231,"parameters":["self"],"return_type":null},{"name":"_get_tools_list","line":383,"parameters":["self"],"return_type":"List[Dict]"},{"name":"_get_tool_by_name","line":439,"parameters":["self","tool_name: str"],"return_type":"Optional[Dict]"},{"name":"_check_tool_permission","line":444,"parameters":["self","token_scope: str","required_scope: str"],"return_type":"bool"},{"name":"run","line":679,"parameters":["self","host: str = '0.0.0.0'","port: int = 8000"],"return_type":null}]}],"functions":[{"name":"main","line":687,"parameters":[],"return_type":null}],"imports":[{"module":"os","type":"standard","alias":null},{"module":"sys","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"time","type":"standard","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"typing","type":"standard","from":"Optional","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null},{"module":"typing","type":"standard","from":"Any","alias":null},{"module":"typing","type":"standard","from":"List","alias":null},{"module":"asyncio","type":"standard","alias":null},{"module":"fastapi","type":"external","from":"FastAPI","alias":null},{"module":"fastapi","type":"external","from":"Depends","alias":null},{"module":"fastapi","type":"external","from":"HTTPException","alias":null},{"module":"fastapi","type":"external","from":"Request","alias":null},{"module":"fastapi","type":"external","from":"status","alias":null},{"module":"fastapi.middleware.cors","type":"external","from":"CORSMiddleware","alias":null},{"module":"fastapi.responses","type":"external","from":"JSONResponse","alias":null},{"module":"pydantic","type":"external","from":"BaseModel","alias":null},{"module":"pydantic","type":"external","from":"Field","alias":null},{"module":"uvicorn","type":"external","alias":null},{"module":"database_client","type":"local","from":"MCPDatabaseClient","alias":null},{"module":"geoip_helper","type":"local","from":"get_country_for_ip","alias":null},{"module":"geoip_helper","type":"local","from":"is_private_ip","alias":null},{"module":"ollama_client","type":"local","from":"OllamaClient","alias":null},{"module":"token_auth","type":"local","from":"TokenAuthManager","alias":null},{"module":"token_auth","type":"local","from":"verify_token","alias":null},{"module":"env_loader","type":"local","from":"get_db_config","alias":null},{"module":"env_loader","type":"local","from":"load_env_into_environ","alias":null},{"module":"argparse","type":"standard","alias":null},{"module":"socket","type":"standard","alias":null},{"module":"geoip_helper","type":"local","from":"get_country_for_ip","alias":null},{"module":"geoip_helper","type":"local","from":"is_private_ip","alias":null},{"module":"sys","type":"standard","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"requests","type":"external","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null}],"constants":[],"entry_points":[{"type":"main","line":702}]},{"path":"/home/user/netmonitor/mcp_server/http_bridge_client.py","relative_path":"mcp_server/http_bridge_client.py","checksum_sha256":"90ffeb66f10d1f91ec367b26ce4b2c3db5bf3624a48734f7c2423b53b09ff812","size_bytes":9201,"language":"python","classes":[{"name":"MCPHTTPBridge","line":28,"methods":[{"name":"__init__","line":31,"parameters":["self","api_url: str","api_token: str"],"return_type":null},{"name":"_make_request","line":46,"parameters":["self","method: str","endpoint: str","data: Dict = None"],"return_type":"Dict"},{"name":"list_resources","line":65,"parameters":["self"],"return_type":"Dict"},{"name":"read_resource","line":69,"parameters":["self","uri: str"],"return_type":"Dict"},{"name":"list_tools","line":77,"parameters":["self"],"return_type":"Dict"},{"name":"call_tool","line":81,"parameters":["self","tool_name: str","parameters: Dict"],"return_type":"Dict"}]}],"functions":[{"name":"main","line":224,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"json","type":"standard","alias":null},{"module":"os","type":"standard","alias":null},{"module":"asyncio","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"typing","type":"standard","from":"Any","alias":null},{"module":"typing","type":"standard","from":"Dict","alias":null},{"module":"requests","type":"external","alias":null}],"constants":[],"entry_points":[{"type":"main","line":247}]},{"path":"/home/user/netmonitor/mcp_server/legacy_stdio_sse/server.py","relative_path":"mcp_server/legacy_stdio_sse/server.py","checksum_sha256":"b44f631f2f668a5c76af307247c5005bf9404ca1e3e15a2e6e5c67cf3a04d028","size_bytes":99981,"language":"python","classes":[{"name":"NetMonitorMCPServer","line":82,"methods":[{"name":"__init__","line":85,"parameters":["self"],"return_type":null},{"name":"_connect_database","line":102,"parameters":["self"],"return_type":null},{"name":"_initialize_ollama","line":126,"parameters":["self"],"return_type":null},{"name":"_register_handlers","line":144,"parameters":["self"],"return_type":null},{"name":"_identify_attack_phases","line":991,"parameters":["self","timeline: list"],"return_type":"dict"},{"name":"_generate_timeline_summary","line":1017,"parameters":["self","timeline: list"],"return_type":"str"},{"name":"run_stdio","line":2474,"parameters":["self"],"return_type":null},{"name":"run_sse","line":2500,"parameters":["self","host: str = '0.0.0.0'","port: int = 3000"],"return_type":null}]}],"functions":[{"name":"main","line":2540,"parameters":[],"return_type":null}],"imports":[{"module":"os","type":"standard","alias":null},{"module":"sys","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"json","type":"standard","alias":null},{"module":"csv","type":"standard","alias":null},{"module":"io","type":"standard","alias":null},{"module":"socket","type":"standard","alias":null},{"module":"argparse","type":"standard","alias":null},{"module":"asyncio","type":"standard","alias":null},{"module":"yaml","type":"external","alias":null},{"module":"datetime","type":"standard","from":"datetime","alias":null},{"module":"typing","type":"standard","from":"Any","alias":null},{"module":"typing","type":"standard","from":"Sequence","alias":null},{"module":"pathlib","type":"standard","from":"Path","alias":null},{"module":"mcp.server","type":"external","from":"Server","alias":null},{"module":"mcp.server","type":"external","from":"NotificationOptions","alias":null},{"module":"mcp.server.stdio","type":"external","from":"stdio_server","alias":null},{"module":"mcp.server.models","type":"external","from":"InitializationOptions","alias":null},{"module":"mcp.types","type":"external","from":"Resource","alias":null},{"module":"mcp.types","type":"external","from":"Tool","alias":null},{"module":"mcp.types","type":"external","from":"TextContent","alias":null},{"module":"mcp.types","type":"external","from":"ImageContent","alias":null},{"module":"mcp.types","type":"external","from":"EmbeddedResource","alias":null},{"module":"mcp.types","type":"external","from":"LoggingLevel","alias":null},{"module":"psycopg2","type":"external","alias":null},{"module":"psycopg2.extras","type":"external","alias":null},{"module":"database_client","type":"local","from":"MCPDatabaseClient","alias":null},{"module":"geoip_helper","type":"local","from":"get_country_for_ip","alias":null},{"module":"geoip_helper","type":"local","from":"is_private_ip","alias":null},{"module":"ollama_client","type":"local","from":"OllamaClient","alias":null},{"module":"starlette.applications","type":"external","from":"Starlette","alias":null},{"module":"starlette.routing","type":"external","from":"Route","alias":null},{"module":"starlette.responses","type":"external","from":"Response","alias":null},{"module":"sse_starlette.sse","type":"external","from":"EventSourceResponse","alias":null},{"module":"uvicorn","type":"external","alias":null},{"module":"env_loader","type":"local","from":"get_db_config","alias":null},{"module":"env_loader","type":"local","from":"load_env_into_environ","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"database","type":"local","from":"DatabaseManager","alias":null},{"module":"datetime","type":"standard","from":"timedelta","alias":null},{"module":"requests","type":"external","alias":null},{"module":"requests","type":"external","alias":null},{"module":"requests","type":"external","alias":null},{"module":"requests","type":"external","alias":null},{"module":"requests","type":"external","alias":null},{"module":"requests","type":"external","alias":null},{"module":"mcp.server.sse","type":"external","from":"sse_server","alias":null}],"constants":[],"entry_points":[{"type":"main","line":2578}]},{"path":"/home/user/netmonitor/mcp_server/legacy_stdio_sse/mcp_sse_bridge.py","relative_path":"mcp_server/legacy_stdio_sse/mcp_sse_bridge.py","checksum_sha256":"0ecee6699d9cfe5e29078ac05c5f1c83ad07a67d670fb3ae8f213e04503c77ce","size_bytes":6150,"language":"python","classes":[{"name":"SSEBridge","line":29,"methods":[{"name":"__init__","line":32,"parameters":["self","sse_url: str"],"return_type":null},{"name":"write_stdout","line":134,"parameters":["self","message: dict"],"return_type":null}]}],"functions":[{"name":"main","line":159,"parameters":[],"return_type":null}],"imports":[{"module":"sys","type":"standard","alias":null},{"module":"json","type":"standard","alias":null},{"module":"asyncio","type":"standard","alias":null},{"module":"argparse","type":"standard","alias":null},{"module":"logging","type":"standard","alias":null},{"module":"typing","type":"standard","from":"Optional","alias":null},{"module":"aiohttp","type":"external","alias":null}],"constants":[],"entry_points":[{"type":"main","line":189}]},{"path":"/home/user/netmonitor/config.yaml","relative_path":"config.yaml","checksum_sha256":"2ba87bd15479b9e5389c1eba8338382c148125644eba5683816965a5636d54d8","size_bytes":7776,"language":"yaml","structure":{"self_monitor":{"enabled":true,"sensor_id":"soc-server","hostname":"","location":"SOC Server - Main Location","interface":"lo"},"interface":"lo","internal_networks":["10.0.0.0/8","172.16.0.0/12","192.168.0.0/16"],"thresholds":{"port_scan":{"enabled":true,"unique_ports":20,"time_window":60},"connection_flood":{"enabled":true,"connections_per_second":100,"time_window":10},"packet_size":{"enabled":true,"min_suspicious_size":1400},"dns_tunnel":{"enabled":true,"query_length_threshold":50,"queries_per_minute":150},"icmp_tunnel":{"enabled":true,"size_threshold":500,"rate_threshold":10},"http_anomaly":{"enabled":true,"post_threshold":50,"post_time_window":300,"dlp_min_payload_size":1024,"entropy_threshold":6.5},"smtp_ftp_transfer":{"enabled":true,"size_threshold_mb":50,"time_window":300},"dns_enhanced":{"dga_threshold":0.6,"entropy_threshold":4.5,"encoding_detection":true},"beaconing":{"enabled":true,"min_connections":5,"max_jitter_percent":20},"outbound_volume":{"enabled":true,"threshold_mb":100,"time_window":300},"lateral_movement":{"enabled":true,"unique_targets":5,"time_window":300},"brute_force":{"enabled":true,"attempts_threshold":5,"time_window":300},"protocol_mismatch":{"enabled":true,"detect_http_non_standard":true,"detect_ssh_non_standard":true,"detect_dns_non_standard":true,"detect_ftp_non_standard":true}},"blacklist":["192.0.2.0/24"],"whitelist":["127.0.0.1","192.168.1.0/24"],"logging":{"level":"INFO","file":"/var/log/netmonitor/alerts.log","console":true,"syslog":false},"alerts":{"max_per_minute":100,"file_enabled":true,"syslog_enabled":false,"syslog_facility":"local0"},"threat_feeds":{"enabled":true,"feeds":["feodotracker","urlhaus","threatfox","sslblacklist"],"update_interval":3600,"cache_dir":"/var/cache/netmonitor/feeds"},"abuseipdb":{"enabled":false,"api_key":"","rate_limit":1000,"threshold":50,"query_suspicious_only":true},"dashboard":{"enabled":true,"host":"0.0.0.0","port":8080},"database":{"type":"postgresql","postgresql":{"host":"localhost","port":5432,"database":"netmonitor","user":"netmonitor","password":"netmonitor","min_connections":2,"max_connections":10},"sqlite":{"path":"/var/lib/netmonitor/netmonitor.db"}}}},{"path":"/home/user/netmonitor/config-sensor-minimal.yaml","relative_path":"config-sensor-minimal.yaml","checksum_sha256":"ada05785fbc9a6c7cd7e23025e3168e59132a98c630fcddeade6a1e001180abd","size_bytes":3551,"language":"yaml","structure":{"sensor":{"id":"nano-sensor-01","auth_token":"","hostname":"","location":"Office Network - VLAN 10"},"server":{"url":"https://soc.example.com","verify_ssl":true,"heartbeat_interval":30,"config_sync_interval":300,"metrics_interval":60,"alert_batch_interval":60},"interface":"eth0","internal_networks":["10.0.0.0/8","172.16.0.0/12","192.168.0.0/16"],"logging":{"level":"INFO","console":true,"file":"/var/log/netmonitor/sensor.log","syslog":false}}},{"path":"/home/user/netmonitor/codebase_analysis.json","relative_path":"codebase_analysis.json","checksum_sha256":"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855","size_bytes":0,"language":"json","parse_error":"Expecting value: line 1 column 1 (char 0)"},{"path":"/home/user/netmonitor/mcp_server/claude_desktop_config_http.json","relative_path":"mcp_server/claude_desktop_config_http.json","checksum_sha256":"c5ffa5ec3420c58f8f55cce615f18d6fd042363c7327451a2a748123a1c387ef","size_bytes":293,"language":"json","structure":{"mcpServers":{"netmonitor-soc":{"command":"python3","args":["/opt/netmonitor/mcp_server/http_bridge_client.py"],"env":{"MCP_HTTP_URL":"https://soc.poort.net:8000","MCP_HTTP_TOKEN":"YOUR_API_TOKEN_HERE"}}}}},{"path":"/home/user/netmonitor/mcp_server/legacy_stdio_sse/claude_desktop_config_sse.json","relative_path":"mcp_server/legacy_stdio_sse/claude_desktop_config_sse.json","checksum_sha256":"e6ac2c279dd216508ba4a6c4eb107d8ddc4ab9298e17d07f398d90079b7b527d","size_bytes":127,"language":"json","structure":{"mcpServers":{"netmonitor-soc":{"url":"http://soc.poort.net:3000/sse","transport":"sse"}}}},{"path":"/home/user/netmonitor/mcp_server/legacy_stdio_sse/claude_desktop_config.json","relative_path":"mcp_server/legacy_stdio_sse/claude_desktop_config.json","checksum_sha256":"6e9cdcc08f6cd83ac9add8fa603b5693ad7b28b23f022a3621d6c06e9b9d4afd","size_bytes":421,"language":"json","structure":{"mcpServers":{"netmonitor-soc":{"command":"python3","args":["/home/user/netmonitor/mcp_server/server.py"],"env":{"NETMONITOR_DB_HOST":"localhost","NETMONITOR_DB_PORT":"5432","NETMONITOR_DB_NAME":"netmonitor","NETMONITOR_DB_USER":"mcp_readonly","NETMONITOR_DB_PASSWORD":"mcp_netmonitor_readonly_2024"}}}}},{"path":"/home/user/netmonitor/nginx-netmonitor.conf","relative_path":"nginx-netmonitor.conf","checksum_sha256":"3d1c7f6462d871a81eee998f866da685faac3156e0a43e87f35c85a010584bd1","size_bytes":6541,"language":"conf","content_preview":"# Nginx Configuration for NetMonitor SOC\n# Complete setup with SSL and built-in authentication\n\n# Upstream voor de dashboard backend\n# BELANGRIJK: Deze poort moet overeenkomen met:\n#   - config.yaml -> dashboard.port (default: 8080)\n#   - .env -> DASHBOARD_PORT (default: 8080)\n#   - web_dashboard.py command line: python3 web_dashboard.py -p 8080\nupstream netmonitor_dashboard {\n    server 127.0.0.1:8080;\n    keepalive 32;\n}\n\n# HTTP -> HTTPS redirect\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name soc.example.com;  # WIJZIG NAAR JE DOMEIN\n\n    # Let's Encrypt ACME challenge\n    location /.well-known/acme-challenge/ {\n        root /var/www/certbot;\n    }\n\n    # Redirect all HTTP to HTTPS\n    location / {\n        return 301 https://$server_name$request_uri;\n    }\n}\n\n# HTTPS Server met MFA en CORS\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name soc.example.com;  # WIJZIG NAAR JE DOMEIN\n\n    # SSL Certificaten\n    # GENEREER MET: sudo certbot --nginx -d soc.example.com\n    ssl_certificate /etc/letsencrypt/live/soc.example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/soc.example.com/privkey.pem;\n    ssl_trusted_certificate /etc/letsencrypt/live/soc.example.com/chain.pem;\n\n    # SSL Security Settings (Mozilla Intermediate)\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384';\n    ssl_prefer_server_ciphers off;\n    ssl_session_cache shared:SSL:10m;\n    ssl_session_timeout 10m;\n    ssl_session_tickets off;\n\n    # HSTS (preload list)\n    add_header Strict-Transport-Security \"max-age=63072000; includeSubDomains; preload\" always;\n\n    # Security Headers\n    add_header X-Frame-Options \"SAMEORIGIN\" always;\n    add_header X-Content-Type-Options \"nosniff\" always;\n    add_header X-XSS-Protection \"1; mode=block\" always;\n    add_header Referrer-Policy \"no-referrer-when-downgrade\" always;\n\n    # CORS Headers"}],"dependency_graph":{"update_feeds.py":["threat_feeds"],"web_dashboard.py":["config_defaults","config_loader","database","geoip_helper","sensor_auth","web_auth"],"monitor_config.py":["config_loader","database"],"setup_admin_user.py":["config_loader","database","env_loader","web_auth"],"test_config_sync.py":["config_loader","database"],"netmonitor.py":["abuseipdb_client","alerts","behavior_detector","config_loader","database","detector","metrics_collector","threat_feeds"],"test_detector.py":["config_loader","detector"],"check_active_config.py":["config_loader","database"],"show_2fa_qr.py":["config_loader","database","env_loader"],"setup_sensor_auth.py":["config_loader","database","sensor_auth"],"whitelist_sensors.py":["config_loader","database"],"init_database_defaults.py":["config_loader","database"],"sensor_client.py":["abuseipdb_client","behavior_detector","config_loader","detector","threat_feeds"],"debug_whitelist.py":["config_loader","database"],"debug_config.py":["config_loader","database"],"test_whitelist_query.py":["config_loader","database"],"detector.py":["content_analysis"],"mcp_server/manage_tokens.py":["env_loader","token_auth"],"mcp_server/http_server.py":["database","database_client","env_loader","geoip_helper","ollama_client","token_auth"],"mcp_server/legacy_stdio_sse/server.py":["database","database_client","env_loader","geoip_helper","ollama_client"]},"entry_points":[{"file":"update_feeds.py","type":"main","line":67,"function":null,"route":null,"method":null},{"file":"web_dashboard.py","type":"flask_route","line":278,"function":"login_page","route":"/login","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":286,"function":"api_login","route":"/api/auth/login","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":325,"function":"api_verify_2fa","route":"/api/auth/verify-2fa","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":368,"function":"api_logout","route":"/api/auth/logout","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":383,"function":"api_current_user","route":"/api/auth/current-user","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":389,"function":"api_session_debug","route":"/api/auth/session-debug","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":406,"function":"api_setup_2fa","route":"/api/auth/setup-2fa","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":424,"function":"api_disable_2fa","route":"/api/auth/disable-2fa","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":440,"function":"api_change_password","route":"/api/auth/change-password","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":465,"function":"api_list_users","route":"/api/users","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":478,"function":"api_create_user","route":"/api/users","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":513,"function":"api_deactivate_user","route":"/api/users/<int:user_id>","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":535,"function":"index","route":"/","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":540,"function":"api_status","route":"/api/status","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":550,"function":"api_dashboard","route":"/api/dashboard","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":565,"function":"api_alerts","route":"/api/alerts","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":584,"function":"api_alert_stats","route":"/api/alerts/stats","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":600,"function":"api_acknowledge_alert","route":"/api/alerts/<int:alert_id>/acknowledge","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":619,"function":"api_traffic_history","route":"/api/traffic/history","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":635,"function":"api_top_talkers","route":"/api/top-talkers","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":650,"function":"api_threat_details","route":"/api/threat-details/<threat_type>","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":700,"function":"api_get_sensors","route":"/api/sensors/","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":723,"function":"api_register_sensor","route":"/api/sensors/register","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":755,"function":"api_delete_sensor","route":"/api/sensors/<sensor_id>","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":788,"function":"api_sensor_heartbeat","route":"/api/sensors/<sensor_id>/heartbeat","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":801,"function":"api_submit_sensor_metrics","route":"/api/sensors/<sensor_id>/metrics","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":832,"function":"api_submit_sensor_alerts","route":"/api/sensors/<sensor_id>/alerts","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":895,"function":"api_get_sensor","route":"/api/sensors/<sensor_id>","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":910,"function":"api_create_sensor_command","route":"/api/sensors/<sensor_id>/commands","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":943,"function":"api_get_sensor_commands","route":"/api/sensors/<sensor_id>/commands","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":954,"function":"api_update_command_status","route":"/api/sensors/<sensor_id>/commands/<int:command_id>","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":977,"function":"api_get_command_history","route":"/api/sensors/<sensor_id>/commands/history","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":992,"function":"api_get_whitelist","route":"/api/whitelist","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":1005,"function":"api_add_whitelist","route":"/api/whitelist","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":1041,"function":"api_delete_whitelist","route":"/api/whitelist/<int:entry_id>","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":1055,"function":"api_check_whitelist","route":"/api/whitelist/check/<ip_address>","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":1074,"function":"api_get_config","route":"/api/config","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":1110,"function":"api_get_config_parameters","route":"/api/config/parameters","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":1122,"function":"api_set_config_parameter","route":"/api/config/parameter","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":1169,"function":"api_delete_config_parameter","route":"/api/config/parameter","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":1191,"function":"api_get_config_defaults","route":"/api/config/defaults","method":"ROUTE"},{"file":"web_dashboard.py","type":"flask_route","line":1208,"function":"api_reset_config","route":"/api/config/reset","method":"ROUTE"},{"file":"web_dashboard.py","type":"main","line":1368,"function":null,"route":null,"method":null},{"file":"monitor_config.py","type":"main","line":80,"function":null,"route":null,"method":null},{"file":"setup_admin_user.py","type":"main","line":265,"function":null,"route":null,"method":null},{"file":"test_config_sync.py","type":"main","line":140,"function":null,"route":null,"method":null},{"file":"netmonitor.py","type":"main","line":674,"function":null,"route":null,"method":null},{"file":"test_detector.py","type":"main","line":228,"function":null,"route":null,"method":null},{"file":"check_active_config.py","type":"main","line":126,"function":null,"route":null,"method":null},{"file":"show_2fa_qr.py","type":"main","line":170,"function":null,"route":null,"method":null},{"file":"setup_sensor_auth.py","type":"main","line":119,"function":null,"route":null,"method":null},{"file":"whitelist_sensors.py","type":"main","line":70,"function":null,"route":null,"method":null},{"file":"init_database_defaults.py","type":"main","line":102,"function":null,"route":null,"method":null},{"file":"sensor_client.py","type":"main","line":1122,"function":null,"route":null,"method":null},{"file":"debug_whitelist.py","type":"main","line":168,"function":null,"route":null,"method":null},{"file":"debug_config.py","type":"main","line":136,"function":null,"route":null,"method":null},{"file":"test_whitelist_query.py","type":"main","line":123,"function":null,"route":null,"method":null},{"file":"mcp_server/manage_tokens.py","type":"main","line":332,"function":null,"route":null,"method":null},{"file":"mcp_server/http_server.py","type":"main","line":702,"function":null,"route":null,"method":null},{"file":"mcp_server/http_bridge_client.py","type":"main","line":247,"function":null,"route":null,"method":null},{"file":"mcp_server/legacy_stdio_sse/server.py","type":"main","line":2578,"function":null,"route":null,"method":null},{"file":"mcp_server/legacy_stdio_sse/mcp_sse_bridge.py","type":"main","line":189,"function":null,"route":null,"method":null}],"statistics":{"total_files":48,"python_files":41,"config_files":7,"total_classes":28,"total_functions":106,"total_entry_points":63}}
