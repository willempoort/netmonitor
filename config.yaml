# Network Monitor Configuration

# ============================================================================
# SOC SERVER CONFIGURATION
# ============================================================================
# This section is for the SOC server itself (server-side monitoring)

# Self-Monitoring Settings (SOC Server)
self_monitor:
  # Enable/disable local network monitoring on the SOC server
  # Set to false if you only want to receive alerts from remote sensors
  # NOTE: When enabled, SOC server will appear in sensor list with implicit heartbeat
  #       via metrics (every 60s). No separate sensor_client.py needed.
  enabled: true

  # Sensor ID for the SOC server (must be unique)
  # This is how the SOC server will appear in the sensor list
  sensor_id: soc-server

  # Hostname and location (optional, auto-detected if not specified)
  hostname: ""  # Leave empty for auto-detection
  location: "SOC Server - Main Location"

  # Network interface(s) to monitor on the SOC server
  # Options:
  #   - Single interface: eth0, ens33, etc.
  #   - Multiple interfaces: ens33, ens34, ens35 (comma-separated)
  #   - All interfaces: any
  # IMPORTANT: Default 'lo' only monitors loopback - change for real traffic!
  interface: lo

# ============================================================================
# DETECTION CONFIGURATION
# ============================================================================
# NOTE: For remote sensors, these settings are managed centrally via the
# SOC server dashboard and pushed to sensors automatically.
# Only the SOC server needs these detailed thresholds in config.yaml.

# Network interface to monitor (legacy/backward compatibility)
# When self_monitor.enabled=true, this is overridden by self_monitor.interface
interface: lo

# Internal network ranges (voor internal traffic monitoring)
# Pas deze aan naar je eigen netwerk configuratie
internal_networks:
  - 10.0.0.0/8
  - 172.16.0.0/12
  - 192.168.0.0/16

# Detection thresholds
thresholds:
  # Port scan detection - aantal unieke poorten per source IP per tijdvenster
  port_scan:
    enabled: true
    unique_ports: 20  # Aantal unieke poorten binnen time_window
    time_window: 60   # Tijdvenster in seconden

  # High connection rate detection
  connection_flood:
    enabled: true
    connections_per_second: 100
    time_window: 10

  # Unusual packet size detection
  packet_size:
    enabled: true
    min_suspicious_size: 1400  # Pakketten groter dan deze size zijn verdacht

  # DNS tunneling detection (enhanced met entropy en DGA detection)
  dns_tunnel:
    enabled: true
    query_length_threshold: 50  # DNS queries langer dan dit zijn verdacht
    queries_per_minute: 150     # Verhoogd voor netwerken met monitoring sensoren

  # ICMP tunneling detection
  icmp_tunnel:
    enabled: true
    size_threshold: 500      # ICMP payload >500 bytes is verdacht
    rate_threshold: 10       # >10 large ICMP packets per minute

  # HTTP/HTTPS anomaly detection
  http_anomaly:
    enabled: true
    post_threshold: 50       # Alert bij meer dan X POST requests
    post_time_window: 300    # Tijdvenster in seconden (5 min)
    dlp_min_payload_size: 1024  # Minimale payload size voor DLP scanning (bytes)
    entropy_threshold: 6.5   # Entropy threshold voor encrypted data in plaintext HTTP

  # SMTP/FTP large transfer detection
  smtp_ftp_transfer:
    enabled: true
    size_threshold_mb: 50    # Alert bij meer dan X MB overdracht
    time_window: 300         # Tijdvenster in seconden (5 min)

  # Enhanced DNS detection parameters
  dns_enhanced:
    dga_threshold: 0.6       # DGA score threshold (0-1, hoger = strikter)
    entropy_threshold: 4.5   # Shannon entropy threshold voor DNS queries
    encoding_detection: true # Detecteer Base64/Hex encoding in queries

  # Beaconing detection - detecteert regelmatige callbacks naar C&C servers
  beaconing:
    enabled: true
    min_connections: 5        # Minimaal aantal connecties om te analyseren
    max_jitter_percent: 20    # Max variatie in interval timing (%)

  # Outbound traffic volume monitoring - detecteert data exfiltration
  outbound_volume:
    enabled: true
    threshold_mb: 100         # Alert bij meer dan X MB outbound in time_window
    time_window: 300          # Tijdvenster in seconden (5 min)

  # Lateral movement detection - interne machine scant andere interne machines
  lateral_movement:
    enabled: true
    unique_targets: 5         # Aantal unieke internal IPs
    time_window: 300          # Tijdvenster in seconden

  # Brute force detection - detecteert herhaalde login pogingen
  brute_force:
    enabled: true
    attempts_threshold: 5     # Aantal pogingen dat als verdacht wordt gezien
    time_window: 300          # Tijdvenster in seconden (5 min)

  # Protocol mismatch detection - detecteert protocollen op ongebruikelijke poorten
  protocol_mismatch:
    enabled: true
    detect_http_non_standard: true   # HTTP verkeer op niet-standaard poorten
    detect_ssh_non_standard: true    # SSH verkeer op andere poorten dan 22
    detect_dns_non_standard: true    # DNS verkeer op andere poorten dan 53
    detect_ftp_non_standard: true    # FTP verkeer op andere poorten dan 20/21

# Blacklisted IPs (known malicious IPs)
blacklist:
  - 192.0.2.0/24  # Example RFC5737 test network
  # Voeg hier bekende malicious IPs toe

# Whitelist (trusted IPs that should not trigger alerts)
whitelist:
  - 127.0.0.1
  - 192.168.1.0/24  # Pas aan naar je eigen netwerk

# Logging
logging:
  level: INFO  # DEBUG, INFO, WARNING, ERROR
  file: /var/log/netmonitor/alerts.log
  console: true
  syslog: false

# Alert options
alerts:
  # Maximum aantal alerts per minuut om flooding te voorkomen
  max_per_minute: 100

  # Alert naar file
  file_enabled: true

  # Alert naar syslog
  syslog_enabled: false
  syslog_facility: local0

# Threat Intelligence Feeds
threat_feeds:
  # Enable/disable threat feed integration
  enabled: true

  # Feeds om te gebruiken (alle van abuse.ch zijn gratis)
  feeds:
    - feodotracker    # Botnet C&C servers
    - urlhaus         # Malware distribution URLs
    - threatfox       # Recent IOCs
    - sslblacklist    # SSL/TLS malicious IPs

  # Auto-update interval (in seconden, 3600 = 1 uur)
  update_interval: 3600

  # Cache directory voor feeds
  cache_dir: /var/cache/netmonitor/feeds

# AbuseIPDB API (optioneel, voor real-time IP reputation lookups)
abuseipdb:
  # Enable/disable AbuseIPDB lookups
  enabled: false

  # API key (gratis account op https://www.abuseipdb.com)
  # Laat leeg om te disablen
  api_key: ""

  # Rate limit (gratis tier = 1000/dag)
  rate_limit: 1000

  # Abuse score threshold (0-100, hoger = meer malicious)
  # Alert alleen als score >= threshold
  threshold: 50

  # Query alleen verdachte IPs (beperkt API calls)
  # Als false, wordt elke external IP gechecked (niet aanbevolen)
  query_suspicious_only: true

# Web Dashboard
dashboard:
  # Enable/disable web dashboard
  enabled: true

  # Host en port
  host: 0.0.0.0  # 0.0.0.0 = toegankelijk vanaf andere machines
  port: 8080

  # Flask secret key for session security (optional)
  # Can also be set via FLASK_SECRET_KEY environment variable
  # Generate a secure key with: python3 -c "import secrets; print(secrets.token_hex(32))"
  # secret_key: "your-secret-key-here"

# Database Configuration (PostgreSQL + TimescaleDB)
database:
  # Database type: 'postgresql' or 'sqlite' (legacy)
  type: postgresql

  # PostgreSQL settings
  postgresql:
    host: localhost
    port: 5432
    database: netmonitor
    user: netmonitor
    password: netmonitor  # Change in production!
    min_connections: 2
    max_connections: 10

  # Legacy SQLite (only used if type=sqlite)
  sqlite:
    path: /var/lib/netmonitor/netmonitor.db
