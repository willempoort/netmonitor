# Network Monitor Configuration

# Network interface to monitor (example: eth0, ens33, etc.)
# Use 'any' to monitor all interfaces
interface: lo

# Internal network ranges (voor internal traffic monitoring)
# Pas deze aan naar je eigen netwerk configuratie
internal_networks:
  - 10.0.0.0/8
  - 172.16.0.0/12
  - 192.168.0.0/16

# Detection thresholds
thresholds:
  # Port scan detection - aantal unieke poorten per source IP per tijdvenster
  port_scan:
    enabled: true
    unique_ports: 20  # Aantal unieke poorten binnen time_window
    time_window: 60   # Tijdvenster in seconden

  # High connection rate detection
  connection_flood:
    enabled: true
    connections_per_second: 100
    time_window: 10

  # Unusual packet size detection
  packet_size:
    enabled: true
    min_suspicious_size: 1400  # Pakketten groter dan deze size zijn verdacht

  # DNS tunneling detection
  dns_tunnel:
    enabled: true
    query_length_threshold: 50  # DNS queries langer dan dit zijn verdacht
    queries_per_minute: 150     # Verhoogd voor netwerken met monitoring sensoren

  # Beaconing detection - detecteert regelmatige callbacks naar C&C servers
  beaconing:
    enabled: true
    min_connections: 5        # Minimaal aantal connecties om te analyseren
    max_jitter_percent: 20    # Max variatie in interval timing (%)

  # Outbound traffic volume monitoring - detecteert data exfiltration
  outbound_volume:
    enabled: true
    threshold_mb: 100         # Alert bij meer dan X MB outbound in time_window
    time_window: 300          # Tijdvenster in seconden (5 min)

  # Lateral movement detection - interne machine scant andere interne machines
  lateral_movement:
    enabled: true
    unique_targets: 5         # Aantal unieke internal IPs
    time_window: 300          # Tijdvenster in seconden

# Blacklisted IPs (known malicious IPs)
blacklist:
  - 192.0.2.0/24  # Example RFC5737 test network
  # Voeg hier bekende malicious IPs toe

# Whitelist (trusted IPs that should not trigger alerts)
whitelist:
  - 127.0.0.1
  - 192.168.1.0/24  # Pas aan naar je eigen netwerk

# Logging
logging:
  level: INFO  # DEBUG, INFO, WARNING, ERROR
  file: /var/log/netmonitor/alerts.log
  console: true
  syslog: false

# Alert options
alerts:
  # Maximum aantal alerts per minuut om flooding te voorkomen
  max_per_minute: 100

  # Alert naar file
  file_enabled: true

  # Alert naar syslog
  syslog_enabled: false
  syslog_facility: local0

# Threat Intelligence Feeds
threat_feeds:
  # Enable/disable threat feed integration
  enabled: true

  # Feeds om te gebruiken (alle van abuse.ch zijn gratis)
  feeds:
    - feodotracker    # Botnet C&C servers
    - urlhaus         # Malware distribution URLs
    - threatfox       # Recent IOCs
    - sslblacklist    # SSL/TLS malicious IPs

  # Auto-update interval (in seconden, 3600 = 1 uur)
  update_interval: 3600

  # Cache directory voor feeds
  cache_dir: /var/cache/netmonitor/feeds

# AbuseIPDB API (optioneel, voor real-time IP reputation lookups)
abuseipdb:
  # Enable/disable AbuseIPDB lookups
  enabled: false

  # API key (gratis account op https://www.abuseipdb.com)
  # Laat leeg om te disablen
  api_key: ""

  # Rate limit (gratis tier = 1000/dag)
  rate_limit: 1000

  # Abuse score threshold (0-100, hoger = meer malicious)
  # Alert alleen als score >= threshold
  threshold: 50

  # Query alleen verdachte IPs (beperkt API calls)
  # Als false, wordt elke external IP gechecked (niet aanbevolen)
  query_suspicious_only: true

# Web Dashboard
dashboard:
  # Enable/disable web dashboard
  enabled: true

  # Host en port
  host: 0.0.0.0  # 0.0.0.0 = toegankelijk vanaf andere machines
  port: 8080

  # Flask secret key for session security (optional)
  # Can also be set via FLASK_SECRET_KEY environment variable
  # Generate a secure key with: python3 -c "import secrets; print(secrets.token_hex(32))"
  # secret_key: "your-secret-key-here"

# Database Configuration (PostgreSQL + TimescaleDB)
database:
  # Database type: 'postgresql' or 'sqlite' (legacy)
  type: postgresql

  # PostgreSQL settings
  postgresql:
    host: localhost
    port: 5432
    database: netmonitor
    user: netmonitor
    password: netmonitor  # Change in production!
    min_connections: 2
    max_connections: 10

  # Legacy SQLite (only used if type=sqlite)
  sqlite:
    path: /var/lib/netmonitor/netmonitor.db
