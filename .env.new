# ============================================================================
# NetMonitor Environment Configuration
# ============================================================================
# This file contains:
#   1. Secrets & credentials (API keys, passwords) - NEVER commit to git!
#   2. Deployment settings (server mode, ports) - Deployment-specific
#   3. Runtime paths and directories - Installation-specific
#
# Application configuration (thresholds, features) belongs in config.yaml
#
# Setup:
#   1. Copy this file:    cp .env.example .env
#   2. Edit secrets:      nano .env
#   3. Never commit .env! (already in .gitignore)
#
# SECURITY: .env must never be committed to version control!
# ============================================================================

# ============================================================================
# INSTALLATION PATHS (required by install_services.sh)
# ============================================================================
# Installation directory - CRITICAL for service templates!
# Default: /opt/netmonitor
# WARNING: If you change this, update all references in systemd services
INSTALL_DIR=/opt/netmonitor

# Runtime directories
DATA_DIR=/var/lib/netmonitor
LOG_DIR=/var/log/netmonitor
RUN_DIR=/var/run/netmonitor
CACHE_DIR=/var/cache/netmonitor

# Log configuration
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR
LOG_RETENTION_DAYS=30

# ============================================================================
# DEPLOYMENT SETTINGS (deployment-specific, not secrets)
# ============================================================================
# These settings control how services are installed and run.
# They're in .env because install_services.sh and startup scripts read them.

# Dashboard server mode (embedded|gunicorn)
# embedded = Flask development server in netmonitor.py (simple, 1 service)
#            Good for: small deployments, testing, 1-10 concurrent users
# gunicorn = Production WSGI server (recommended for production, 2 services)
#            Good for: production, 10+ concurrent users, high availability
DASHBOARD_SERVER=gunicorn

# Dashboard network settings
DASHBOARD_HOST=127.0.0.1  # 0.0.0.0 = accessible from network, 127.0.0.1 = localhost only
DASHBOARD_PORT=8080

# Gunicorn workers (only used if DASHBOARD_SERVER=gunicorn)
# Rule of thumb: (2 x CPU cores) + 1
DASHBOARD_WORKERS=4

# MCP HTTP API for AI integration (optional)
MCP_API_ENABLED=true
MCP_API_HOST=127.0.0.1
MCP_API_PORT=8000
MCP_API_WORKERS=4

# MCP reverse proxy support (voor nginx)
# Laat leeg als MCP API direct toegankelijk is (geen reverse proxy)
# Zet op /mcp als je nginx gebruikt met location /mcp/
MCP_ROOT_PATH=/mcp

# MCP CORS configuratie
MCP_CORS_ORIGINS=*

# ============================================================================
# SECRETS & CREDENTIALS
# ============================================================================

# Flask secret key for session security (REQUIRED)
# BELANGRIJK: Genereer een sterke random key voor productie!
# Generate: python3 -c "import secrets; print(secrets.token_hex(32))"
FLASK_SECRET_KEY=3bf9aab6fbef3fe1041ea3f1ef9f48ca95ce3039bc550ad497ae48a46145db0b

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
# Database type (sqlite|postgresql)
# sqlite     = Standaard, geen extra setup nodig
# postgresql = Voor production, MCP API en grotere deployments
DB_TYPE=postgresql

# PostgreSQL configuration
# Host, port, database name, user (password is secret below)
DB_HOST=localhost
DB_PORT=5432
DB_NAME=netmonitor
DB_USER=netmonitor

# PostgreSQL password (SECRET - required if DB_TYPE=postgresql)
DB_PASSWORD=netmonitor

# PostgreSQL connection pooling
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20

# SQLite configuration (legacy - only used if DB_TYPE=sqlite)
SQLITE_PATH=/var/lib/netmonitor/netmonitor.db

# ============================================================================
# THREAT INTELLIGENCE API KEYS
# ============================================================================
# AbuseIPDB API Key (optional - for IP reputation checks)
# Gratis tier: 1000 requests/dag
# Sign up: https://www.abuseipdb.com/api
ABUSEIPDB_API_KEY=4f1da22b7d6a04ad5e185ea8232e6949469a10d50f9db44ffbaee7e8964b0ed386c48b024bca27a1

# MISP Threat Intelligence Platform (optional)
# Zie: docs/features/MISP_SETUP.md
MISP_URL=
MISP_API_KEY=

# AlienVault OTX (optional - gratis)
# Sign up: https://otx.alienvault.com
OTX_API_KEY=

# ============================================================================
# SIEM INTEGRATION CREDENTIALS
# ============================================================================
# Wazuh SIEM (optional)
# Zie: docs/features/WAZUH_SETUP.md
WAZUH_API_URL=
WAZUH_API_USER=
WAZUH_API_PASSWORD=

# Generic Syslog output (optional)
SYSLOG_HOST=
SYSLOG_PORT=514
SYSLOG_PROTOCOL=udp
SYSLOG_FORMAT=cef

# ============================================================================
# NOTIFICATION SECRETS
# ============================================================================
# Email notifications (optional)
SMTP_ENABLED=false
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=
SMTP_TO=

# Slack notifications (optional)
SLACK_ENABLED=false
SLACK_WEBHOOK_URL=

# ============================================================================
# OPTIONAL: NGINX CONFIGURATION
# ============================================================================
# These are only needed if you're using nginx reverse proxy
# Used by nginx config generation scripts
NGINX_SERVER_NAME=soc.poort.net
NGINX_SSL_CERT=/etc/ssl/certs/soc.crt
NGINX_SSL_KEY=/etc/ssl/private/soc.key

# ============================================================================
# OPTIONAL: MONITORING CONFIGURATION
# ============================================================================
# Self-monitoring interface override (also in config.yaml)
# Uncomment to override config.yaml setting
SELF_MONITOR_ENABLED=true
SELF_MONITOR_INTERFACE=ens192

# Threat feed update interval (seconds)
THREAT_FEED_UPDATE_INTERVAL=3600

# ============================================================================
# OPTIONAL: SENSOR CONFIGURATION
# ============================================================================
# Only configure for REMOTE sensors (not SOC server)
# Leave empty if this is the SOC server

# Sensor identification
SENSOR_ID=
SENSOR_NAME=
SENSOR_LOCATION=

# SOC Server connection
SOC_SERVER_URL=
SENSOR_TOKEN=

# Sensor network interface
SENSOR_INTERFACE=

# ============================================================================
# NOTES: What Goes Where?
# ============================================================================
# .env (this file):
#   - Secrets: API keys, passwords, tokens (NEVER commit!)
#   - Deployment: DASHBOARD_SERVER, ports, MCP settings (deployment-specific)
#
# config.yaml:
#   - Application logic: detection thresholds, features, network ranges
#   - Settings shared across deployments (can be committed to git)
#
# Why deployment settings are in .env:
#   - install_services.sh reads DASHBOARD_SERVER to create correct services
#   - netmonitor.py reads DASHBOARD_SERVER at startup
#   - Can't be in config.yaml because scripts need them before loading YAML
#   - Not secrets, but deployment-specific (dev vs prod might differ)
#
# Configuration moved to config.yaml (from old .env):
#   - Database host/port/name → config.yaml: database.postgresql.*
#   - Log levels → config.yaml: logging.level
#   - Feature enables → config.yaml: integrations.*.enabled
#   - Detection thresholds → config.yaml: thresholds.*
#   - Network ranges → config.yaml: internal_networks
# ============================================================================
